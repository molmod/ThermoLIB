

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>(De)projections of the FEP/FES &mdash; ThermoLIB v1.8.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4eaa865d"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Transformations of the FEP/FES" href="ug_transformation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ThermoLIB
              <img src="_static/logo_thermolib_light.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ig.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ig.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#download-and-install-thermolib">Download and install ThermoLIB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ig.html#direct-install-using-pip">Direct install using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="ig.html#source-code-download-and-install">Source code download and install</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#update-thermolib">Update ThermoLIB</a></li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#test-installation">Test installation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="ug.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ug_1DFEP.html">Constructing 1D histograms &amp; free energy profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_1DFEP.html#construct-a-1d-histrogam">Construct a 1D histrogam …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-a-single-simulation">… from a single simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-multiple-simulations-using-wham">… from multiple simulations using WHAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_1DFEP.html#constructing-a-1d-free-energy-profile">Constructing a 1D free energy profile …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#using-the-constructor">… using the constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#reading-from-a-text-file">… reading from a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-a-histogram">… from a histogram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_2DFES.html">Constructing 2D histograms &amp; free energy surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_2DFES.html#constructing-a-2d-histogram">Constructing a 2D histogram …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-single-simulation">… from single simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-multiple-simulations-using-wham">… from multiple simulations using WHAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_2DFES.html#constructing-a-2d-free-energy-surface">Constructing a 2D free energy surface …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#using-the-constructor">… using the constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#reading-from-a-text-file">… reading from a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-a-histogram">… from a histogram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_corrtime.html">Computing the correlation time</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_corrtime.html#fit-to-autocorrelation-function-for-single-trajectory">Fit to autocorrelation function for single trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_corrtime.html#compute-correlation-time-for-trajectory-series">Compute correlation time for trajectory series</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_error.html">Error estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_error.html#without-correlations">Without correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_error.html#with-correlations">With correlations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_plotting.html">Plotting histograms and FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_plotting.html#d-histograms-free-energy-profile">1D Histograms &amp; free energy profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_plotting.html#d-histograms-free-energy-surfaces">2D Histograms &amp; free energy surfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_micromacro.html">Extracting micro- and macrostate free energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ug_kinetics.html">Computing the reaction rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="ug_transformation.html">Transformations of the FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_transformation.html#deterministic-transformation">Deterministic transformation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_transformation.html#dimensional">1 dimensional</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_transformation.html#id1">2 dimensional</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_transformation.html#probabilistic-transformation">Probabilistic transformation</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">(De)projections of the FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#projecting-2d-fes-to-1d-fep">Projecting 2D FES to 1D FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deprojecting-1d-fep-to-2d-fes">Deprojecting 1D FEP to 2D FES</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_wham1d.html">Tutorial 1 - Construction of 1D free energy profile using WHAM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#WHAM-without-error-estimation">WHAM without error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#WHAM-with-error-estimation">WHAM with error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#Defining-macrostates-and-microstates">Defining macrostates and microstates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_kinetics.html">Tutorial 2 - Extracting kinetic reaction rates in 1D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Construct-free-energy-profile">Construct free energy profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Compute-rate-prefactor">Compute rate prefactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Add-kinetic-information-to-FEP-plot">Add kinetic information to FEP plot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_wham2d.html">Tutorial 3 - Construction of 2D free energy surface using WHAM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#2D-WHAM-without-error-estimation">2D WHAM without error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#2D-WHAM-with-error-estimate">2D WHAM with error estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#Alternative-plotting">Alternative plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_error_estimation.html">Tutorial 4 - Advanced techniques in error estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Impact-correlation-between-samples-on-FEP">Impact correlation between samples on FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Estimating-the-autocorrelation-time">Estimating the autocorrelation time</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Constructing-the-FEP-with-correlated-error-estimate">Constructing the FEP with correlated error estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Evaluating-the-correlated-error-estimate">Evaluating the correlated error estimate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Delayed-strided-WHAM-profiles">Delayed-strided WHAM profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Blocked-WHAM-profile">Blocked WHAM profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Bootstrapped-WHAM-profiles">Bootstrapped WHAM profiles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Covariance-between-different-points-on-FEP">Covariance between different points on FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Error-propagation">Error propagation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_projection.html">Tutorial 5 - Projection of 2D FES to 1D FEP with error propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Constructing-2D-FES">Constructing 2D FES</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Projection-onto-1D-profile">Projection onto 1D profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Along-predefined-direction">Along predefined direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Along-any-custom-direction">Along any custom direction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Error-propagation">Error propagation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Deal-with-the-unsufficiently-sampled-edges-of-phase-space-in-FES-projection">Deal with the unsufficiently sampled edges of phase space in FES projection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_deprojection.html">Tutorial 6 - Deprojection to extract energetic contribution to free energy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Construct-1D-FEP">Construct 1D FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Deproject-to-2D-FES">Deproject to 2D FES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Direct-route---2D-WHAM">Direct route - 2D WHAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Indirect-route---deproject-1D-FEP">Indirect route - deproject 1D FEP</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#CONSISTENCY-CHECK:-project-2D-FES-to-1D-FEP">CONSISTENCY CHECK: project 2D FES to 1D FEP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#U(CV)-profile">U(CV) profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Method-1---from-2D-FES">Method 1 - from 2D FES</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Method-2---from-conditional-probability">Method 2 - from conditional probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#comparison">comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_transformations.html">Tutorial 7 - Transformations of 1D FEP and kinetics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#FEP-and-rate-with-original-CV">FEP and rate with original CV</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#FEP-and-rate-in-terms-of-alternative-CV">FEP and rate in terms of alternative CV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_transformations_2D.html">Tutorial 8 - Transformation of 2D free energy surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Construction-of-original-2D-FES">Construction of original 2D FES</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Transformation-to-new-CVs">Transformation to new CVs</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Projection-comparison">Projection comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rg.html">Reference Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rg_thermo.html">Thermodynamics – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#free-energy-profiles-thermolib-thermodynamics-fep">Free energy profiles – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.fep</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#histograms-thermolib-thermodynamics-histogram">Histograms – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.histogram</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#trajectory-readers-thermolib-thermodynamics-trajectory">Trajectory readers – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.trajectory</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#bias-potentials-thermolib-thermodynamics-bias">Bias potentials – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.bias</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#collective-variables-thermolib-thermodynamics-cv">Collective variables – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.cv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#state-thermolib-thermodynamics-state">State – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.state</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_thermo.html#conditional-probability-thermolib-thermodynamics-condprob">Conditional probability – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.condprob</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_kin.html">Kinetics – <code class="docutils literal notranslate"><span class="pre">thermolib.kinetics</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_kin.html#rate-constant-thermolib-kinetics-rate">Rate constant – <code class="docutils literal notranslate"><span class="pre">thermolib.kinetics.rate</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_error.html">Error distributions – <code class="docutils literal notranslate"><span class="pre">thermolib.error</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rg_tools.html">Tools – <code class="docutils literal notranslate"><span class="pre">thermolib.tools</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="rg_ext.html">Extensions – <code class="docutils literal notranslate"><span class="pre">thermolib.ext</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ThermoLIB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="ug.html">User Guide</a></li>
      <li class="breadcrumb-item active">(De)projections of the FEP/FES</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ug_projection.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="de-projections-of-the-fep-fes">
<span id="seclab-ug-projection"></span><h1>(De)projections of the FEP/FES<a class="headerlink" href="#de-projections-of-the-fep-fes" title="Link to this heading"></a></h1>
<section id="projecting-2d-fes-to-1d-fep">
<h2>Projecting 2D FES to 1D FEP<a class="headerlink" href="#projecting-2d-fes-to-1d-fep" title="Link to this heading"></a></h2>
<p>A projection of a 2D Free energy surface towards a 1D free energy profile can be one of the following cases:</p>
<ul class="simple">
<li><p>Projecting out one of the collective variables, e.g. going from <img class="math" src="_images/math/e0ecbc7270243607431c856802437fe405f65041.png" alt="F_{12}(CV_1,CV_2)"/> towards <img class="math" src="_images/math/8db2d596d11e1c72b04af5334ffd28cdeb58c41a.png" alt="F_1(CV_1)"/></p></li>
<li><p>Projecting to a function of the original two collective variables, i.e. going from <img class="math" src="_images/math/96683bee7cb6a4f51b3d824fec7d81b752868480.png" alt="F_2(CV_1,CV_2)"/> towards <img class="math" src="_images/math/0df1ea76650961da6ab2055fdcd0637fae7cba94.png" alt="F_1(Q)"/> with <img class="math" src="_images/math/9c8392f50a6bc6a0898ebd0d2339e9dc49ed9a78.png" alt="Q=f(CV_1,CV_2)"/></p></li>
</ul>
<p>The first case is as easy as applying the <code class="xref py py-meth docutils literal notranslate"><span class="pre">project_cv1</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">project_cv2</span></code> routine:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fep1</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">project_cv1</span><span class="p">()</span>
<span class="c1">#or</span>
<span class="n">fep2</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">project_cv2</span><span class="p">()</span>
</pre></div>
</div>
<p>The second case can be done by application of the <code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code> routine which requires the definition of the function <img class="math" src="_images/math/9c8392f50a6bc6a0898ebd0d2339e9dc49ed9a78.png" alt="Q=f(CV_1,CV_2)"/> in a similar fashion as was the case in transformations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#define function</span>
<span class="k">def</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">cv1</span><span class="p">,</span> <span class="n">cv2</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">cv2</span><span class="o">-</span><span class="n">cv1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="c1">#define range of bins of new collective variable</span>
<span class="n">qs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

<span class="c1">#apply projection</span>
<span class="n">fep</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">project_function</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
</pre></div>
</div>
<p>In case the function is simply the average <img class="math" src="_images/math/6b0c56e544d1ce4735f851ce9a9651e8d8446542.png" alt="Q=0.5\cdot(CV_1+CV_2)"/> or the difference <img class="math" src="_images/math/e392f5e05394988768a5ef5890c867d175896b4f.png" alt="Q=CV_2-CV_1"/>, one can use the already implemented specific routines <code class="xref py py-meth docutils literal notranslate"><span class="pre">project_average</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">project_difference</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fep_avg</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">project_average</span><span class="p">()</span>
<span class="c1">#or</span>
<span class="n">fep_diff</span> <span class="o">=</span> <span class="n">fes</span><span class="o">.</span><span class="n">project_difference</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="deprojecting-1d-fep-to-2d-fes">
<h2>Deprojecting 1D FEP to 2D FES<a class="headerlink" href="#deprojecting-1d-fep-to-2d-fes" title="Link to this heading"></a></h2>
<p>To do a deprojection of a 1D FEP <img class="math" src="_images/math/1566b81bc1b85b2253b2bbfaba40df6d4593a668.png" alt="F_1(CV)"/> towards a 2D free energy surface <img class="math" src="_images/math/f1b528a798c7ce7e72fbcd981ad7f06c62ad0caf.png" alt="F_{12}(Q_1,Q_2)"/>, knowledge of only <img class="math" src="_images/math/1566b81bc1b85b2253b2bbfaba40df6d4593a668.png" alt="F_1(CV)"/> is insufficient and additional information from the original simulation is required. Depending on the situation, multiple approaches to do this are possible. The first, most general, approach is based on Bayes rule</p>
<div class="math">
<p><img src="_images/math/550856391b820bda8959fd28f6d9fde84d9f53d3.png" alt="F_{12}(Q_1,Q_2) &amp;= -k_BT\log\left[\int P(Q_1,Q_2|CV)\cdot e^{-\beta F_1(CV)} dCV\right]"/></p>
</div><p>and, hence, involves construction of the conditional probability <img class="math" src="_images/math/a2b491e74465c8d41b162967c21b9cd737ac3fee.png" alt="P(Q_1,Q_2|CV)"/>. This property represents the probability that the system is in a state with a specific value of Q1 and Q2, given that the system was in a state with specific value of <em>CV</em> and can be extracted from the original simulation data using the <code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalProbability1D2D</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#initialize conditional probability</span>
<span class="n">condprob</span> <span class="o">=</span> <span class="n">ConditionalProbability1D2D</span><span class="p">()</span>

<span class="c1">#initialize TrajectoryReaders to extract CV and Q1, Q2 values from trajectory files</span>
<span class="n">cv_reader</span> <span class="o">=</span> <span class="n">ColVarReader</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">q1_reader</span> <span class="o">=</span> <span class="n">ColVarReader</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="n">q2_reader</span> <span class="o">=</span> <span class="n">ColVarReader</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#Read trajectory files and extract samples for conditional probability</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntraj</span><span class="p">):</span>
    <span class="n">condprob</span><span class="o">.</span><span class="n">process_simulation</span><span class="p">(</span>
        <span class="p">[(</span><span class="s1">&#39;COLVAR_</span><span class="si">%i</span><span class="s1">.dat&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">q1_reader</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;COLVAR_</span><span class="si">%i</span><span class="s1">.dat&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">q2_reader</span><span class="p">)],</span>
        <span class="p">[(</span><span class="s1">&#39;COLVAR_</span><span class="si">%i</span><span class="s1">.dat&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">cv_reader</span><span class="p">)],</span>
    <span class="p">)</span>

<span class="c1">#Compute conditional probability in given bin ranges</span>
<span class="n">bins_cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="n">bins_q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="n">bins_q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="n">condprob</span><span class="o">.</span><span class="n">finish</span><span class="p">([</span><span class="n">bins_q1</span><span class="p">,</span><span class="n">bins_q2</span><span class="p">],</span> <span class="p">[</span><span class="n">bins_cv</span><span class="p">])</span>
</pre></div>
</div>
<p>This conditional probability can be plotted using its <code class="xref py py-meth docutils literal notranslate"><span class="pre">plot</span></code> routine. Finally, the 2D free energy surface <img class="math" src="_images/math/f1b528a798c7ce7e72fbcd981ad7f06c62ad0caf.png" alt="F_{12}(Q_1,Q_2)"/> can now be constructed from the 1D FEP and the conditional probability as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fes</span> <span class="o">=</span> <span class="n">condprob</span><span class="o">.</span><span class="n">deproject</span><span class="p">(</span><span class="n">fep</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case we would like to deproject towards new CVs in which Q1 is just the original CV, i.e. <img class="math" src="_images/math/5ce8c05cd75863cc6cd77c07398913ddd8a507e4.png" alt="Q_1=CV"/>, we can make some simplifications to the Bayes theory resulting in</p>
<div class="math">
<p><img src="_images/math/8ac6d72ad9947f13399c3e168a986b25feee7d7b.png" alt="F(CV,Q) &amp;= F(CV) - k_BT\log\left[P(Q|CV)\right]"/></p>
</div><p>and use the <code class="xref py py-class docutils literal notranslate"><span class="pre">ConditionalProbability1D1D</span></code> class to implement this</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#initialize conditional probability</span>
<span class="n">condprob</span> <span class="o">=</span> <span class="n">ConditionalProbability1D1D</span><span class="p">()</span>

<span class="c1">#initialize TrajectoryReaders to extract CV and Q values from trajectory files</span>
<span class="n">cv_reader</span> <span class="o">=</span> <span class="n">ColVarReader</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">q_reader</span>  <span class="o">=</span> <span class="n">ColVarReader</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#Read trajectory files and extract samples for conditional probability</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntraj</span><span class="p">):</span>
    <span class="n">condprob</span><span class="o">.</span><span class="n">process_simulation</span><span class="p">(</span>
        <span class="p">[(</span><span class="s1">&#39;COLVAR_</span><span class="si">%i</span><span class="s1">.dat&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">q_reader</span><span class="p">)],</span>
        <span class="p">[(</span><span class="s1">&#39;COLVAR_</span><span class="si">%i</span><span class="s1">.dat&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">cv_reader</span><span class="p">)],</span>
    <span class="p">)</span>

<span class="c1">#Compute conditional probability in given bin ranges</span>
<span class="n">bins_cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="n">bins_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
<span class="n">condprob</span><span class="o">.</span><span class="n">finish</span><span class="p">([</span><span class="n">bins_q</span><span class="p">],</span> <span class="p">[</span><span class="n">bins_cv</span><span class="p">])</span>

<span class="c1">#construct deprojected 2D FES</span>
<span class="n">fes</span> <span class="o">=</span> <span class="n">condprob</span><span class="o">.</span><span class="n">deproject</span><span class="p">(</span><span class="n">fep</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, as a second alternative method to get the 2D FES in this specific situation, one could also have done a 2D WHAM using the original simulation data biased along one of these CVs as was described in <a class="reference internal" href="ug_2DFES.html#seclab-ug-2dhistogram-wham-scenario2"><span class="std std-ref">SCENARIO 2 of constructing a 2D histogram from WHAM</span></a>.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ug_transformation.html" class="btn btn-neutral float-left" title="Transformations of the FEP/FES" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Louis Vanduyfhuys.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>