<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thermodynamics – thermolib.thermodynamics &mdash; ThermoLIB v1.7.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=131c94de"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Kinetics – thermolib.kinetics" href="rg_kin.html" />
    <link rel="prev" title="Reference Guide" href="rg.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ThermoLIB
              <img src="_static/logo_thermolib_light.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ig.html">Installation Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ig.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#download-and-install-thermolib">Download and install ThermoLIB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ig.html#direct-install-using-pip">Direct install using pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="ig.html#developers-download">Developers download</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#update-thermolib">Update ThermoLIB</a></li>
<li class="toctree-l2"><a class="reference internal" href="ig.html#test-installation">Test installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ug.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ug_1DFEP.html">Constructing 1D histograms &amp; free energy profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_1DFEP.html#construct-a-1d-histrogam">Construct a 1D histrogam …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-a-single-simulation">… from a single simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-multiple-simulations-using-wham">… from multiple simulations using WHAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_1DFEP.html#constructing-a-1d-free-energy-profile">Constructing a 1D free energy profile …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#using-the-constructor">… using the constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#reading-from-a-text-file">… reading from a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_1DFEP.html#from-a-histogram">… from a histogram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_2DFES.html">Constructing 2D histograms &amp; free energy surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_2DFES.html#constructing-a-2d-histogram">Constructing a 2D histogram …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-single-simulation">… from single simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-multiple-simulations-using-wham">… from multiple simulations using WHAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_2DFES.html#constructing-a-2d-free-energy-surface">Constructing a 2D free energy surface …</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#using-the-constructor">… using the constructor</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#reading-from-a-text-file">… reading from a text file</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_2DFES.html#from-a-histogram">… from a histogram</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_corrtime.html">Computing the correlation time</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_corrtime.html#fit-to-autocorrelation-function-for-single-trajectory">Fit to autocorrelation function for single trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_corrtime.html#compute-correlation-time-for-trajectory-series">Compute correlation time for trajectory series</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_error.html">Error estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_error.html#without-correlations">Without correlations</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_error.html#with-correlations">With correlations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_plotting.html">Plotting histograms and FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_plotting.html#d-histograms-free-energy-profile">1D Histograms &amp; free energy profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_plotting.html#d-histograms-free-energy-surfaces">2D Histograms &amp; free energy surfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_micromacro.html">Extracting micro- and macrostate free energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ug_kinetics.html">Computing the reaction rate</a></li>
<li class="toctree-l2"><a class="reference internal" href="ug_transformation.html">Transformations of the FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_transformation.html#deterministic-transformation">Deterministic transformation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ug_transformation.html#dimensional">1 dimensional</a></li>
<li class="toctree-l4"><a class="reference internal" href="ug_transformation.html#id1">2 dimensional</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ug_transformation.html#probabilistic-transformation">Probabilistic transformation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ug_projection.html">(De)projections of the FEP/FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ug_projection.html#projecting-2d-fes-to-1d-fep">Projecting 2D FES to 1D FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="ug_projection.html#deprojecting-1d-fep-to-2d-fes">Deprojecting 1D FEP to 2D FES</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_wham1d.html">Tutorial 1 - Construction of 1D free energy profile using WHAM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#WHAM-without-error-estimation">WHAM without error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#WHAM-with-error-estimation">WHAM with error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham1d.html#Defining-macrostates-and-microstates">Defining macrostates and microstates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_kinetics.html">Tutorial 2 - Extracting kinetic reaction rates in 1D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Construct-free-energy-profile">Construct free energy profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Compute-rate-prefactor">Compute rate prefactor</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_kinetics.html#Add-kinetic-information-to-FEP-plot">Add kinetic information to FEP plot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/basic_wham2d.html">Tutorial 3 - Construction of 2D free energy surface using WHAM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#2D-WHAM-without-error-estimation">2D WHAM without error estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#2D-WHAM-with-error-estimate">2D WHAM with error estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/basic_wham2d.html#Alternative-plotting">Alternative plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_error_estimation.html">Tutorial 4 - Advanced techniques in error estimation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Impact-correlation-between-samples-on-FEP">Impact correlation between samples on FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Estimating-the-autocorrelation-time">Estimating the autocorrelation time</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Constructing-the-FEP-with-correlated-error-estimate">Constructing the FEP with correlated error estimate</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Evaluating-the-correlated-error-estimate">Evaluating the correlated error estimate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Delayed-strided-WHAM-profiles">Delayed-strided WHAM profiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Blocked-WHAM-profile">Blocked WHAM profile</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_error_estimation.html#Bootstrapped-WHAM-profiles">Bootstrapped WHAM profiles</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Covariance-between-different-points-on-FEP">Covariance between different points on FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_error_estimation.html#Error-propagation">Error propagation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_projection.html">Tutorial 5 - Projection of 2D FES to 1D FEP with error propagation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Constructing-2D-FES">Constructing 2D FES</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Projection-onto-1D-profile">Projection onto 1D profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Along-predefined-direction">Along predefined direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Along-any-custom-direction">Along any custom direction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_projection.html#Error-propagation">Error propagation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_projection.html#Deal-with-the-unsufficiently-sampled-edges-of-phase-space-in-FES-projection">Deal with the unsufficiently sampled edges of phase space in FES projection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_deprojection.html">Tutorial 6 - Deprojecting 1D FEP to 2D FES</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Construct-1D-FEP">Construct 1D FEP</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#Deproject-to-2D-FES">Deproject to 2D FES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Direct-route---2D-WHAM">Direct route - 2D WHAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Indirect-route---deproject-1D-FEP">Indirect route - deproject 1D FEP</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#CONSISTENCY-CHECK:-project-2D-FES-to-1D-FEP">CONSISTENCY CHECK: project 2D FES to 1D FEP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_deprojection.html#U(CV)-profile">U(CV) profile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Method-1---from-2D-FES">Method 1 - from 2D FES</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#Method-2---from-conditional-probability">Method 2 - from conditional probability</a></li>
<li class="toctree-l4"><a class="reference internal" href="tut/advanced_deprojection.html#comparison">comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_transformations.html">Tutorial 7 - Transformations of 1D FEP and kinetics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#FEP-and-rate-with-original-CV">FEP and rate with original CV</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations.html#FEP-and-rate-in-terms-of-alternative-CV">FEP and rate in terms of alternative CV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tut/advanced_transformations_2D.html">Tutorial 8 - Transformation of 2D free energy surfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Construction-of-original-2D-FES">Construction of original 2D FES</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Transformation-to-new-CVs">Transformation to new CVs</a></li>
<li class="toctree-l3"><a class="reference internal" href="tut/advanced_transformations_2D.html#Projection-comparison">Projection comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="rg.html">Reference Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Thermodynamics – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.fep">Free energy profiles – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.fep</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile"><code class="docutils literal notranslate"><span class="pre">BaseProfile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D"><code class="docutils literal notranslate"><span class="pre">FreeEnergySurface2D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile"><code class="docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.fep.plot_profiles"><code class="docutils literal notranslate"><span class="pre">plot_profiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.histogram">Histograms – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.histogram</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram1D"><code class="docutils literal notranslate"><span class="pre">Histogram1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram2D"><code class="docutils literal notranslate"><span class="pre">Histogram2D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.histogram.plot_histograms"><code class="docutils literal notranslate"><span class="pre">plot_histograms()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.trajectory">Trajectory readers – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.trajectory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.trajectory.ASEExtendedXYZReader"><code class="docutils literal notranslate"><span class="pre">ASEExtendedXYZReader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.trajectory.CVComputer"><code class="docutils literal notranslate"><span class="pre">CVComputer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.trajectory.ColVarReader"><code class="docutils literal notranslate"><span class="pre">ColVarReader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.trajectory.HDF5Reader"><code class="docutils literal notranslate"><span class="pre">HDF5Reader</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.bias">Bias potentials – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.bias</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D"><code class="docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential2D"><code class="docutils literal notranslate"><span class="pre">BiasPotential2D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.MultipleBiasses1D"><code class="docutils literal notranslate"><span class="pre">MultipleBiasses1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.Parabola1D"><code class="docutils literal notranslate"><span class="pre">Parabola1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.Parabola2D"><code class="docutils literal notranslate"><span class="pre">Parabola2D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.PlumedSplinePotential1D"><code class="docutils literal notranslate"><span class="pre">PlumedSplinePotential1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.bias.Polynomial1D"><code class="docutils literal notranslate"><span class="pre">Polynomial1D</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.cv">Collective variables – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.cv</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.Average"><code class="docutils literal notranslate"><span class="pre">Average</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.CenterOfMass"><code class="docutils literal notranslate"><span class="pre">CenterOfMass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.CenterOfPosition"><code class="docutils literal notranslate"><span class="pre">CenterOfPosition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.CoordinationNumber"><code class="docutils literal notranslate"><span class="pre">CoordinationNumber</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.Difference"><code class="docutils literal notranslate"><span class="pre">Difference</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.DistOrthProjOrig"><code class="docutils literal notranslate"><span class="pre">DistOrthProjOrig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.Distance"><code class="docutils literal notranslate"><span class="pre">Distance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.DistanceCOP"><code class="docutils literal notranslate"><span class="pre">DistanceCOP</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.DotProduct"><code class="docutils literal notranslate"><span class="pre">DotProduct</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.LinearCombination"><code class="docutils literal notranslate"><span class="pre">LinearCombination</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.Minimum"><code class="docutils literal notranslate"><span class="pre">Minimum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.NormalToPlane"><code class="docutils literal notranslate"><span class="pre">NormalToPlane</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.NormalizedAxis"><code class="docutils literal notranslate"><span class="pre">NormalizedAxis</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.cv.OrthogonalDistanceToPore"><code class="docutils literal notranslate"><span class="pre">OrthogonalDistanceToPore</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.state">State – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.state</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.state.Integrate"><code class="docutils literal notranslate"><span class="pre">Integrate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.state.Maximum"><code class="docutils literal notranslate"><span class="pre">Maximum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.state.Minimum"><code class="docutils literal notranslate"><span class="pre">Minimum</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-thermolib.thermodynamics.condprob">Conditional probability – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.condprob</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D"><code class="docutils literal notranslate"><span class="pre">ConditionalProbability1D1D</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D2D"><code class="docutils literal notranslate"><span class="pre">ConditionalProbability1D2D</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_kin.html">Kinetics – <code class="docutils literal notranslate"><span class="pre">thermolib.kinetics</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_kin.html#module-thermolib.kinetics.rate">Rate constant – <code class="docutils literal notranslate"><span class="pre">thermolib.kinetics.rate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_kin.html#thermolib.kinetics.rate.BaseRateFactor"><code class="docutils literal notranslate"><span class="pre">BaseRateFactor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_kin.html#thermolib.kinetics.rate.RateFactorEquilibrium"><code class="docutils literal notranslate"><span class="pre">RateFactorEquilibrium</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_error.html">Error distributions – <code class="docutils literal notranslate"><span class="pre">thermolib.error</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.ErrorArray"><code class="docutils literal notranslate"><span class="pre">ErrorArray</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.ErrorArray.mean"><code class="docutils literal notranslate"><span class="pre">ErrorArray.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.ErrorArray.nsigma_conf_int"><code class="docutils literal notranslate"><span class="pre">ErrorArray.nsigma_conf_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.ErrorArray.sample"><code class="docutils literal notranslate"><span class="pre">ErrorArray.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.ErrorArray.std"><code class="docutils literal notranslate"><span class="pre">ErrorArray.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.copy"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.from_samples"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.from_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.log_from_loggaussian"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.log_from_loggaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.mean"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.nsigma_conf_int"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.nsigma_conf_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.print"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.print()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.sample"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.set_ref"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.set_ref()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.shift"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.shift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution.std"><code class="docutils literal notranslate"><span class="pre">GaussianDistribution.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.copy"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.exp_from_gaussian"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.exp_from_gaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.from_samples"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.from_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.mean"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.nsigma_conf_int"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.nsigma_conf_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.sample"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.set_ref"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.set_ref()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.shift"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.shift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.LogGaussianDistribution.std"><code class="docutils literal notranslate"><span class="pre">LogGaussianDistribution.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.MultiDistribution"><code class="docutils literal notranslate"><span class="pre">MultiDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiDistribution.corr"><code class="docutils literal notranslate"><span class="pre">MultiDistribution.corr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.copy"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.cov"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.cov()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.from_samples"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.from_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.log_from_loggaussian"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.log_from_loggaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.mean"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.nsigma_conf_int"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.nsigma_conf_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.plot_corr_matrix"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.plot_corr_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.sample"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.set_ref"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.set_ref()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution.std"><code class="docutils literal notranslate"><span class="pre">MultiGaussianDistribution.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.copy"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.cov"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.cov()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.exp_from_gaussian"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.exp_from_gaussian()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.from_samples"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.from_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.mean"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.nsigma_conf_int"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.nsigma_conf_int()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.plot_corr_matrix"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.plot_corr_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.sample"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.MultiLogGaussianDistribution.std"><code class="docutils literal notranslate"><span class="pre">MultiLogGaussianDistribution.std()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.Propagator"><code class="docutils literal notranslate"><span class="pre">Propagator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.Propagator.calc_fun_values"><code class="docutils literal notranslate"><span class="pre">Propagator.calc_fun_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.Propagator.gen_args_samples"><code class="docutils literal notranslate"><span class="pre">Propagator.gen_args_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.Propagator.get_distribution"><code class="docutils literal notranslate"><span class="pre">Propagator.get_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.Propagator.reset"><code class="docutils literal notranslate"><span class="pre">Propagator.reset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution"><code class="docutils literal notranslate"><span class="pre">SampleDistribution</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.from_samples"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.from_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.mean"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.mean()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.sample"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.set_ref"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.set_ref()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.shift"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.shift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="rg_error.html#thermolib.error.SampleDistribution.std"><code class="docutils literal notranslate"><span class="pre">SampleDistribution.std()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_tools.html">Tools – <code class="docutils literal notranslate"><span class="pre">thermolib.tools</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.blav"><code class="docutils literal notranslate"><span class="pre">blav()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.corrtime_from_acf"><code class="docutils literal notranslate"><span class="pre">corrtime_from_acf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.decorrelate"><code class="docutils literal notranslate"><span class="pre">decorrelate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.extract_polynomial_bias_info"><code class="docutils literal notranslate"><span class="pre">extract_polynomial_bias_info()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.fisher_matrix_mle_probdens"><code class="docutils literal notranslate"><span class="pre">fisher_matrix_mle_probdens()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.format_scientific"><code class="docutils literal notranslate"><span class="pre">format_scientific()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.h5_read_dataset"><code class="docutils literal notranslate"><span class="pre">h5_read_dataset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.integrate"><code class="docutils literal notranslate"><span class="pre">integrate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.integrate2d"><code class="docutils literal notranslate"><span class="pre">integrate2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.interpolate_surface_2d"><code class="docutils literal notranslate"><span class="pre">interpolate_surface_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.invert_fisher_to_covariance"><code class="docutils literal notranslate"><span class="pre">invert_fisher_to_covariance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.multivariate_normal"><code class="docutils literal notranslate"><span class="pre">multivariate_normal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.read_wham_input"><code class="docutils literal notranslate"><span class="pre">read_wham_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_tools.html#thermolib.tools.rolling_average"><code class="docutils literal notranslate"><span class="pre">rolling_average()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rg_ext.html">Extensions – <code class="docutils literal notranslate"><span class="pre">thermolib.ext</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_bias"><code class="docutils literal notranslate"><span class="pre">wham1d_bias()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_error"><code class="docutils literal notranslate"><span class="pre">wham1d_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_hs"><code class="docutils literal notranslate"><span class="pre">wham1d_hs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_scf"><code class="docutils literal notranslate"><span class="pre">wham1d_scf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_bias"><code class="docutils literal notranslate"><span class="pre">wham2d_bias()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_error"><code class="docutils literal notranslate"><span class="pre">wham2d_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_hs"><code class="docutils literal notranslate"><span class="pre">wham2d_hs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_scf"><code class="docutils literal notranslate"><span class="pre">wham2d_scf()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ThermoLIB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="rg.html">Reference Guide</a></li>
      <li class="breadcrumb-item active">Thermodynamics – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/rg_thermo.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="thermodynamics-thermolib-thermodynamics">
<h1>Thermodynamics – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics</span></code><a class="headerlink" href="#thermodynamics-thermolib-thermodynamics" title="Permalink to this heading"></a></h1>
<section id="module-thermolib.thermodynamics.fep">
<span id="free-energy-profiles-thermolib-thermodynamics-fep"></span><span id="seclab-rg-modules-fep"></span><h2>Free energy profiles – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.fep</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.fep" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.fep.</span></span><span class="sig-name descname"><span class="pre">BaseFreeEnergyProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="Permalink to this definition"></a></dt>
<dd><p>Child class of <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a> to define a (free) energy profile <img class="math" src="_images/math/b9ec4309e2f5046075de8b94d22ce7d41983d684.png" alt="F(CV)"/> (stored in self.fs) as function of a certain collective variable <img class="math" src="_images/math/14f8653cb145d24503ca65a35998301c5a3196fc.png" alt="CV"/> (stored in self.cvs). This class will set some defaults choices as well as define  additional attributes and routines specific for manipulation of free energy profiles.</p>
<p>See documentation of <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a> for meaning of meaning of arguments not documented below..</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temp</strong> (<em>float</em>) – the temperature at which the free energy is constructed, which should be in atomic units!</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile.from_histogram">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histogram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label='F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit='kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile.from_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile.from_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Use the probability histogram <img class="math" src="_images/math/e7c993a4284806b9febffa41587624d295fafb70.png" alt="p(CV)"/> to construct the corresponding free energy profile <img class="math" src="_images/math/b9ec4309e2f5046075de8b94d22ce7d41983d684.png" alt="F(CV)"/> at the given temperature using the following formula</p>
<div class="math">
<p><img src="_images/math/611b0991d2e4788d2e3edab5acb55df7fd6deaab.png" alt="F(CV) = -k_BT\log\left(p(CV)\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histogram</strong> (<a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram1D" title="thermolib.thermodynamics.histogram.Histogram1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram1D</span></code></a>) – histogram from which the free energy profile is computed</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which the histogram input data was simulated, in atomic units.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>default=None</em>) – the units for printing and plotting of CV values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module. If None is given, the cv_output_unit attribute of the histogram instance is used.</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>default='kjmol'</em>) – <p>the units for printing and plotting of free energy values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – label for the CV for printing and plotting. If None is given, the cv_label attribute of the histogram instance is used.</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='F'</em>) – label for the free energy for printing and plotting</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile.from_txt">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fstdcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile.from_txt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile.from_txt" title="Permalink to this definition"></a></dt>
<dd><p>See documentation off parent class routine <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile.from_txt" title="thermolib.thermodynamics.fep.BaseProfile.from_txt"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile.from_txt</span></code></a> for meaning of arguments not documented below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temp</strong> (<em>float</em>) – temperature corresponding to the free (energy) profile (in atomic units, hence, in kelvin).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile.process_states">
<span class="sig-name descname"><span class="pre">process_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile.process_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile.process_states" title="Permalink to this definition"></a></dt>
<dd><p>This routine is not implemented in the current class, but only in its child classes (see e.g. <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile.process_states</span></code></a>)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile.recollect">
<span class="sig-name descname"><span class="pre">recollect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qs_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_new_fes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile.recollect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile.recollect" title="Permalink to this definition"></a></dt>
<dd><p>Redefine the CV array to the new given array. For each interval of new CV values, collect all old free energy values for which the corresponding CV value falls in this new interval and average out. As such, this routine can be used to filter out noise on a given free energy profile by means of averaging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qs_new</strong> (<em>np.ndarray</em>) – Array of new CV values</p></li>
<li><p><strong>interpolate</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to True, the free energy of bins on the new grid in which not a single old grid point ends up will be interpolated from the neighboring bins</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, make a plot illustrating the recollection. It will show (1) the original FEP on the original CV grid, i.e. (CV[i],F[i]) in black crosses, as well as (2) the (possibly interpolated) recollection of this FEP on a newly defined Q-grid, i.e. use the specified Q-grid or define one automatically and average/interpolate the free energy in the new bins based on the (CV[i],F[i]) data, in a blue line and finally (3) the new Q-grid points for which no free energy was found (because no transformed data ended up in it and it could not be interpolated from neighbors) will be indicated as gray dashed verticle lines.</p></li>
<li><p><strong>return_new_fes</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If set to False, the recollected data will be written to the current instance (overwritting the original data). If set to True, a new instance will be initialized with the recollected data and returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns an instance of the current class if the keyword argument <cite>return_new_fes</cite> is set to True. Otherwise, None is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or instance of same class as self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseFreeEnergyProfile.transform_function">
<span class="sig-name descname"><span class="pre">transform_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derivative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs_new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f(CV)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseFreeEnergyProfile.transform_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile.transform_function" title="Permalink to this definition"></a></dt>
<dd><p>Routine to transform the current free energy profile in terms of the original <img class="math" src="_images/math/14f8653cb145d24503ca65a35998301c5a3196fc.png" alt="CV"/> towards a free energy profile in terms of a new collective variable <img class="math" src="_images/math/7be32c70d3762ce1246c529c1859d22fd743f00f.png" alt="Q=f(CV)"/> according to the formula:</p>
<div class="math">
<p><img src="_images/math/ed446fcfe9cb54a02abd68ebce80d3f65c0d49a3.png" alt="F_2(Q) &amp;= F_1(f^{-1}(Q)) + k_B T \log\left[\frac{df}{dCV}(f^{-1}(Q))\right]"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<em>callable</em>) – The transformation function relating the old CV to the new Q, i.e. <img class="math" src="_images/math/7be32c70d3762ce1246c529c1859d22fd743f00f.png" alt="Q=f(CV)"/></p></li>
<li><p><strong>derivative</strong> (<em>callable</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – The analytical derivative of the transformation function <img class="math" src="_images/math/5b7752c757e0b691a80ab8227eadb8a8389dc58a.png" alt="f"/>. If set to None, the derivative will be estimated through numerical differentiation.</p></li>
<li><p><strong>qs_new</strong> (<em>np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – grid points for the new Q grid. If None, a uniform grid will be constructed between f(CV[0]) and f(CV[-1]) with equal number of points as the original CV grid.</p></li>
<li><p><strong>interpolate</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if set to True, the free energy of bins on the new grid in which not a single old grid point ends up will be interpolated from the neighboring bins</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='f</em><em>(</em><em>CV</em><em>)</em><em>'</em>) – The label of the new collective variable used in plotting etc</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>The unit of the new collective varaible used in plotting and printing. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, make a plot illustrating the transformation. It will show (1) the transformation of the original FEP on the transformed CV grid, i.e. (Q[i],F_Q[i]) with <img class="math" src="_images/math/4b54cc5f56cd03282b5a2a2fb0709f04b8d4a39a.png" alt="Q[i]=f(CV[i])"/> and <img class="math" src="_images/math/221a76c0c2079baf451a44d4f7dd00007ec2f63b.png" alt="F_Q[i]=F(CV[i]) + k_BT\log\left[\frac{df}{dCV}(CV[i])\right]"/> in black crosses, as well as (2) the (possibly interpolated) recollection of this new FEP on a newly defined Q-grid, i.e. use the specified Q-grid or define one automatically and average/interpolate the free energy in the new bins based on the (Q[i],F_Q[i]) data, in a blue line and finally (3) the new Q-grid points for which no free energy was found (because no transformed data ended up in it and it could not be interpolated from neighbors) will be indicated as gray dashed verticle lines.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=self.error.__class__)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transformed free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>the same class as the instance this routine is called upon</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if self.error is a distribution that is neither an instance of <a class="reference internal" href="rg_error.html#thermolib.error.GaussianDistribution" title="thermolib.error.GaussianDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianDistribution</span></code></a> nor of <a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution" title="thermolib.error.MultiGaussianDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiGaussianDistribution</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.fep.</span></span><span class="sig-name descname"><span class="pre">BaseProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile" title="Permalink to this definition"></a></dt>
<dd><p>Base parent class to define a 1D profile of a property X as function of a certain collective variable (CV). This class will be used as the basis for (free) energy profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cvs</strong> (<em>np.ndarray</em>) – <p>the collective variable values, which should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>fs</strong> (<em>np.ndarray</em>) – <p>the values of the property X, which should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>error</strong> (child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code> class, optional) – error distribution on the profile, defaults to None</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>default='au'</em>) – <p>the units for printing and plotting of CV values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>default='kjmol'</em>) – <p>the units for printing and plotting of free energy values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label for the CV for printing and plotting</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='X'</em>) – label for the observable X for printing and plotting</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvrange</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.crop" title="Permalink to this definition"></a></dt>
<dd><p>Crop the profile to the given cvrange and throw away cropped data. This routine will alter the data in the current profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cvrange</strong> (<em>tuple</em>) – the range of the collective variable defining the new range to which the FEP will be cropped.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.flower">
<span class="sig-name descname"><span class="pre">flower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.flower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.flower" title="Permalink to this definition"></a></dt>
<dd><p>Return the lower limit of an n-sigma error bar on the profile property, i.e. <img class="math" src="_images/math/3276b7139ebcf34cc3889ec6c7513b7cab9b44af.png" alt="\mu - n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the lower limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.from_average">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.from_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.from_average" title="Permalink to this definition"></a></dt>
<dd><p>Construct a profile as the average of a set of given profiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profiles</strong> (list of instances of <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a> (or one of its child classes such as <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a> or <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile</span></code></a>)) – set of profiles to be averaged</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – <p>the units for printing and plotting of CV values. If None, use the value of the <code class="docutils literal notranslate"><span class="pre">cv_output_unit</span></code> attribute of the first profile. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – label for the collective variable in plots. If None, use the value of the <code class="docutils literal notranslate"><span class="pre">cv_label</span></code> attribute of the first profile.</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None.</em>) – <p>the units for printing and plotting of X values (not the unit of the input array, that is defined by x_input_unit). If None, use the value of the <code class="docutils literal notranslate"><span class="pre">f_output_unit</span></code> attribute of the first profile. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – label for the X observable in plots. If None, use the value of the <code class="docutils literal notranslate"><span class="pre">f_label</span></code> attribute of the first profile.</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – method of estimating the error. Currently, only <em>std</em> is supported, which computes the error from the standard deviation within the set of profiles.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.from_txt">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fstdcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.from_txt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.from_txt" title="Permalink to this definition"></a></dt>
<dd><p>Read the a property profile (and optionally its error bar) as function of a collective variable from a txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em>) – the name of the txt file (assumed to be readable by numpy.loadtxt) containing the data</p></li>
<li><p><strong>cvcol</strong> (<em>int</em><em>, </em><em>default=0</em>) – index of the column in which the collective variable is stored</p></li>
<li><p><strong>fcol</strong> (<em>int</em><em>, </em><em>default=1</em>) – index of the column in which the observable X is stored.</p></li>
<li><p><strong>fstdcol</strong> (<em>int</em><em>, </em><em>default=None</em>) – index of the column in which the standard deviation of observable X is stored, which is used to construct an error distribution. If None, no standard deviation will be read and no error bar will be computed.</p></li>
<li><p><strong>cv_input_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>default='au'</em>) – <p>the units in which the CV values are stored in the file. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_input_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>default='kjmol'</em>) – <p>the units in which the observable X values are stored in the file. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>default='au'</em>) – <p>the units for printing and plotting of CV values (not the unit of the input array, that is defined by cv_input_unit). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em> or </em><em>float</em><em>, </em><em>default='kjmol'</em>) – <p>the units for printing and plotting of observable X values (not the unit of the input array, that is defined by x_input_unit). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label for the CV for printing and plotting</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='X'</em>) – label for the property X for printing and plotting</p></li>
<li><p><strong>cvrange</strong> (<em>tuple</em><em> or </em><em>list</em><em>, </em><em>default=None</em>) – only read the property X for CVs in the given range. If None, all data is read</p></li>
<li><p><strong>delimiter</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – The delimiter used in the txt input file to separate columns. If None, use the default of <a class="reference external" href="https://numpy.org/doc/1.20/reference/generated/numpy.loadtxt.html">the numpy.loadtxt routine</a> (i.e. whitespace).</p></li>
<li><p><strong>reverse</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to True, reverse the CV and X values (usefull to make sure reactant is on the left)</p></li>
<li><p><strong>cut_constant</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to True, the data points at the start and end of the data array that are constant will be cut. Usefull to cut out unsampled areas for large and small CV values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.fupper">
<span class="sig-name descname"><span class="pre">fupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.fupper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.fupper" title="Permalink to this definition"></a></dt>
<dd><p>Return the upper limit of an n-sigma error bar on the profile property, i.e. <img class="math" src="_images/math/02e68f36c49d38f9917878ab017c3dcb1207cac4.png" alt="\mu + n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the upper limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['value']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvlims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the property stored in the current profile as function of the CV. If the error distribution is stored in self.error, various statistical quantities besides the estimated mean property (such as the error width, lower/upper limit on the error bar, random sample) can be plotted using the <code class="docutils literal notranslate"><span class="pre">obss</span></code> keyword. You can specify additional matplotlib keyword arguments that will be parsed to the matplotlib plotter (<cite>plot</cite> and/or <cite>fill_between</cite>) at the end of the argument list of this routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of a file to save plot to. If None, the plot will not be saved to a file.</p></li>
<li><p><strong>obss</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>'value'</em><em>]</em>) – <p>Specify which statistical property/properties to plot. Multiple values are allowed, which will be plotted on the same figure. Following options are supported:</p>
<ul>
<li><p><strong>value</strong> - the values stored in self.fs</p></li>
<li><p><strong>mean</strong> - the mean according to the error distribution, i.e. self.error.mean()</p></li>
<li><p><strong>lower</strong> - the lower limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[0]</p></li>
<li><p><strong>upper</strong> - the upper limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[1]</p></li>
<li><p><strong>error</strong> - half the width of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. abs(upper-lower)/2</p></li>
<li><p><strong>sample</strong> - a random sample taken from the error distribution, i.e. self.error.sample()</p></li>
</ul>
</p></li>
<li><p><strong>linestyles</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line style (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, all linestyles are set to ‘-’</p></li>
<li><p><strong>linewidths</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line width (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, al linewidths are set to 1</p></li>
<li><p><strong>colors</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the color (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>cvlims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the cv. If None, no limits are enforced</p></li>
<li><p><strong>flims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the X property. If None, no limits are enforced</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – If True, the legend is shown in the plot</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the <code class="docutils literal notranslate"><span class="pre">obs</span></code> argument contains an invalid specification</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.plot_corr_matrix">
<span class="sig-name descname"><span class="pre">plot_corr_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'bwr'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.plot_corr_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.plot_corr_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Make a 2D filled contour plot of the correlation matrix (i.e. the normalized covariance matrix) containing the correlation between every pair of points on the X profile. This correlation ranges from +1 (red when cmap=’bwr’) over 0 (white when cmap=’bwr’) to -1 (blue when cmap=’bwr’). For easy interpretation, the plot of the X profile itself is included above the correlation plot (top pane).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of file to save the plot to. If None, the plot is not saved</p></li>
<li><p><strong>flims</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Limit the plotting range of the X property in the original profile plot included in the top pane.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='bwr'</em>) – Specification of the matplotlib color map for the 2D plot of the correlation matrix</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – when self.error is not specified (as this is needed to compute the correlation matrix)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.savetxt">
<span class="sig-name descname"><span class="pre">savetxt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn_txt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.savetxt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.savetxt" title="Permalink to this definition"></a></dt>
<dd><p>Save the current profile as txt file. The values of CV and X are written in units specified by the cv_output_unit and f_output_unit attributes of the self instance. If the error attribute of self is not None, the corresponding std values will be written to the file as well in the third column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn_txt</strong> (<em>str</em>) – name for the output file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.BaseProfile.set_ref">
<span class="sig-name descname"><span class="pre">set_ref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#BaseProfile.set_ref"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.BaseProfile.set_ref" title="Permalink to this definition"></a></dt>
<dd><p>Set the zero energy reference of the profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ref</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em><em>, </em><em>default='min'</em>) – the choice for the zero reference of X. Currently only ‘min’, ‘max’ or an integer is implemented, resulting in setting the value of the minimum, maximum or X[i] to zero respectively.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IOError</strong> – invalid value for keyword argument ref is given. See doc above for choices.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.fep.</span></span><span class="sig-name descname"><span class="pre">FreeEnergySurface2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D" title="Permalink to this definition"></a></dt>
<dd><p>Class implementing a 2D free energy surface F(CV1,CV2) (stored in self.fs) as function of two collective variables (CV) denoted by CV1 (stored in self.cv1s) and CV2 (stored in self.cv2s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1s</strong> (<em>np.ndarray</em>) – <p>array containing the values for the first collective variable CV1. Should be given in atomic units. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2s</strong> – <p>array the values for the second collective variable CV2. Should be given in atomic units. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>fs</strong> (<em>np.ndarray</em>) – <p>2D array containing the free energy values corresponding to the given values of CV1 and CV2 in xy indexing. Should be given in atomic units. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – <p>temperature at which the free energy is given. Should be given in atomic units. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>error</strong> (child of <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code>, optional, default=None) – error distribution on the free energy profile, defaults to None</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>defaults to 'au'</em>) – <p>unit in which the CV1 values will be printed/plotted, not the unit in which the input array is given (which is assumed to be atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>defaults to 'au'</em>) – <p>unit in which the CV2 values will be printed/plotted, not the unit in which the input array is given (which is assumed to be atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – <p>unit in which the free energy values will be printe/plotted, not the unit in which the input array f is given (which is assumed to be kjmol). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – label of CV1 for printing and plotting</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2'</em>) – label of CV2 for printing and plotting</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='F'</em>) – label for the free energy for printing and plotting</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.copy" title="Permalink to this definition"></a></dt>
<dd><p>Make and return a copy of the current FreeEnergySurface2D instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-inf,</span> <span class="pre">inf]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-inf,</span> <span class="pre">inf]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_new_fes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.crop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.crop" title="Permalink to this definition"></a></dt>
<dd><p>Crop the free energy surface by removing all data for which either cv1 or cv2 is beyond a given range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1range</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-np.inf</em><em>,</em><em>np.inf</em><em>]</em>) – range of cv1 (along x-axis) that will remain after cropping</p></li>
<li><p><strong>cv2range</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-np.inf</em><em>,</em><em>np.inf</em><em>]</em>) – range of cv2 (along y-axis) that will remain after cropping</p></li>
<li><p><strong>return_new_fes</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to false, the cropping process will be applied on the existing instance, otherwise a copy will be returned</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new cropped FES if <code class="docutils literal notranslate"><span class="pre">return_new_fes=True</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D" title="thermolib.thermodynamics.fep.FreeEnergySurface2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">FreeEnerySurface2D</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.detect_clusters">
<span class="sig-name descname"><span class="pre">detect_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.detect_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.detect_clusters" title="Permalink to this definition"></a></dt>
<dd><p>Routine to apply <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html">the DBSCAN clustering algoritm as implemented in the Scikit Learn package</a> to the (CV1,CV2) grid points that correspond to finite free energies (i.e. not nan or inf) to detect clusters of neighboring points.</p>
<p>The DBSCAN algorithm first identifies the core samples, defined as samples for which at least <code class="docutils literal notranslate"><span class="pre">min_samples</span></code> other samples are within a distance of <code class="docutils literal notranslate"><span class="pre">eps</span></code>. Next, the data is divided into clusters based on these core samples. A cluster is defined as a set of core samples that can be built by recursively taking a core sample, finding all of its neighbors that are core samples, finding all of their neighbors that are core samples, and so on. A cluster also has a set of non-core samples, which are samples that are neighbors of a core sample in the cluster but are not themselves core samples. Intuitively, these samples are on the fringes of a cluster. Each cluster is given an integer as label.</p>
<p>Any sample that is not a core sample, and is at least <code class="docutils literal notranslate"><span class="pre">eps</span></code> in distance from any core sample, is considered an outlier by the algorithm and is what we here consider an isolated point/region. These points get the cluster label of -1.</p>
<p>Finally, all data points belonging to a cluster with label specified in <code class="docutils literal notranslate"><span class="pre">delete_clusters</span></code> will have theire free energy set to nan. A safe choice here is to just delete isolated regions, i.e. the point in cluster with label -1 (which is the default).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1.5</em>) – DBSCAN parameter representing maximum distance between two samples for them to be considered neighbors (for more, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html">DBSCAN documentation</a>)</p></li>
<li><p><strong>min_samples</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=8</em>) – <p>DBSCAN parameter representing the number of samples in a neighborhood for a point to be considered a core point (for more, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html">DBSCAN documentation</a>)</p>
</p></li>
<li><p><strong>metric</strong> (<em>str</em><em> or </em><em>callable</em><em>, </em><em>optional</em><em>, </em><em>default='euclidean'</em>) – <p>DBSCAN parameter representing the metric used when calculating distance (for more, see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html">DBSCAN documentation</a>)</p>
</p></li>
<li><p><strong>fn_plot</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – if specified, a plot will be made (and written to <code class="docutils literal notranslate"><span class="pre">fn_plot</span></code>) visualizing the resulting clusters</p></li>
<li><p><strong>delete_clusters</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-1</em><em>]</em>) – list of cluster names whos members will be deleted from the free energy surface data. If set to to [-1], only isolated points (not belonging to a cluster) will be deleted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.flower">
<span class="sig-name descname"><span class="pre">flower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.flower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.flower" title="Permalink to this definition"></a></dt>
<dd><p>Return the lower limit of an n-sigma error bar, i.e. <img class="math" src="_images/math/3276b7139ebcf34cc3889ec6c7513b7cab9b44af.png" alt="\mu - n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the lower limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.from_histogram">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histogram</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit='kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label='F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.from_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.from_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Use the 2D probability histogram <img class="math" src="_images/math/64fb75c3632427dc9745dc390467d26ee7361109.png" alt="p(CV1,CV2)"/> to construct the corresponding 2D free energy surface at the given temperature using the following formula</p>
<div class="math">
<p><img src="_images/math/72f1883a7ea48df2ce45fda4ad60cbbddbb264c0.png" alt="F(CV1,CV2) = -k_BT\log\left(p(CV1,CV2)\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histogram</strong> (<a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram2D" title="thermolib.thermodynamics.histogram.Histogram2D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram2D</span></code></a>) – histogram from which the free energy profile is computed</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which the histogram input data was simulated</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>default=None</em>) – <p>the units for printing and plotting of CV1 values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module. If None is given, the cv1_output_unit attribute of the histogram instance is used.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>default=None</em>) – <p>the units for printing and plotting of CV2 values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module. If None is given, the cv2_output_unit attribute of the histogram instance is used.</p>
</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>default='kjmol'</em>) – <p>the units for printing and plotting of free energy values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – label for the CV1 for printing and plotting. If None is given, the cv1_label attribute of the histogram instance is used.</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – label for the CV2 for printing and plotting. If None is given, the cv2_label attribute of the histogram instance is used.</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='F'</em>) – label for the free energy for printing and plotting</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – if the histogram.error could not be properly interpretated.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.from_txt">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_txt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_input_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.from_txt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.from_txt" title="Permalink to this definition"></a></dt>
<dd><p>Read the free energy surface on a 2D grid as function of two collective variables from a txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em>) – the name of the txt file (assumed to be readable by numpy.loadtxt) containing the data.</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which the free energy is given</p></li>
<li><p><strong>cv1_col</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – the column in which the first collective variable is stored</p></li>
<li><p><strong>cv2_col</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – the column in which the second collective variable is stored</p></li>
<li><p><strong>f_col</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – the column in which the free energy is stored</p></li>
<li><p><strong>cv1_input_unit</strong> – the unit in which the first CV values are stored in the input file</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>unit in which the CV1 values will be printed/plotted, not the unit in which the input array is given (which is given by cv1_input_unit). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_input_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – the unit in which the second CV values are stored in the input file</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – <p>unit in which the CV2 values will be printed/plotted, not the unit in which the input array is given (which is given by cv2_input_unit). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>f_input_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – the unit in which the free energy values are stored in the input file</p></li>
<li><p><strong>f_output_unit</strong> – <p>unit in which the free energy values will be printed/plotted, not the unit in which the input array is given (which is given by f_input_unit). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – the label for the CV1 axis in plots</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2'</em>) – the label for the CV2 axis in plots, defaults to ‘CV2’</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='F'</em>) – label for the free energy for printing and plotting</p></li>
<li><p><strong>delimiter</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the delimiter used in the numpy input file, this argument is parsed to the numpy.loadtxt routine.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, increase logging verbosity</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D free energy surface</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D" title="thermolib.thermodynamics.fep.FreeEnergySurface2D">FreeEnergySurface2D</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.fupper">
<span class="sig-name descname"><span class="pre">fupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.fupper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.fupper" title="Permalink to this definition"></a></dt>
<dd><p>Return the upper limit of an n-sigma error bar, i.e. <img class="math" src="_images/math/02e68f36c49d38f9917878ab017c3dcb1207cac4.png" alt="\mu + n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the upper limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolation_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_new_fes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.interpolate" title="Permalink to this definition"></a></dt>
<dd><p>If the current FES has bins for which the free energy is np.nan, look if that bin has neighbors (up to X-nearest neighbors with X=interpolation_depth) in all four directions (left/right, up/down) that have a defined free energy (i.e. not np.nan) and interpolate between those 4 values. Only do this if all 4 neighbors have defined free energy to avoid extending the edges. The main part of this routine is implemented in <a class="reference internal" href="rg_tools.html#thermolib.tools.interpolate_surface_2d" title="thermolib.tools.interpolate_surface_2d"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interpolate_surface_2d</span></code></a>, while the current routine serves mainly as a wrapper to do propper error propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interpolation_depth</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=3</em>) – interpolation_depth parameter parsed to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">inerpolate_surface_2d</span></code> routine. See documentation in that routine for more details.</p></li>
<li><p><strong>return_new_fes</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If set to False, the interpolated data will be written to the current instance of FreeEnergySurface2D. If set to True, a new instance of FreeEnergySurface2D will be returned.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=self.error.__class__, samples_are_flattened=True)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[slice(None,</span> <span class="pre">None,</span> <span class="pre">None),</span> <span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['value']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_additional_function_contours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.plot" title="Permalink to this definition"></a></dt>
<dd><p>Make either a 2D contour plot of F(CV1,CV2) or a 1D sliced plot of F along a slice in the direction specified by the slicer argument. Appart from the value of the free energy itself, other (statistical) related properties can be plotted as defined in the obbs argument. At the end of the argument list, you can also specify any matplotlib keyword arguments you wish to parse to the matplotlib plotter. E.g. if you want to specify the colormap, you can just add at the end of the arguments <code class="docutils literal notranslate"><span class="pre">cmap='rainbow'</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of a file to save plot to. If None, the plot will not be saved to a file.</p></li>
<li><p><strong>slicer</strong> (list of <a class="reference external" href="https://www.w3schools.com/python/ref_func_slice.asp">slices</a> or integers, optional, default=[slice(None),slice(None)]) – <p>determines which degrees of freedom (CV1/CV2) vary/stay fixed in the plot. If slice(none) is specified, the free energy will be plotted as function of the corresponding CV. If an integer <cite>i</cite> is specified, that corresponding CV will be kept fixed at its <cite>i-th</cite> value. Some examples:</p>
<ul>
<li><p>[slice(None),slice(Nonne)] – a 2D contour plot will be made of F as function of both CVs</p></li>
<li><p>[slice(None),10] – a 1D plot will be made of F as function of CV1 with CV2 fixed at self.cv2s[10]</p></li>
<li><p>[23,slice(None)] – a 1D plot will be made of F as function of CV2 with CV1 fixed at self.cv1s[23]</p></li>
</ul>
</p></li>
<li><p><strong>obss</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>'value'</em><em>]</em>) – <p>Specify which statistical property/properties to plot. Multiple values are allowed, which will be plotted on the same figure. Following options are supported:</p>
<ul>
<li><p><strong>value</strong> - the values stored in self.fs</p></li>
<li><p><strong>mean</strong> - the mean according to the error distribution, i.e. self.error.mean()</p></li>
<li><p><strong>lower</strong> - the lower limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[0]</p></li>
<li><p><strong>upper</strong> - the upper limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[1]</p></li>
<li><p><strong>error</strong> - half the width of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. abs(upper-lower)/2</p></li>
<li><p><strong>sample</strong> - a random sample taken from the error distribution, i.e. self.error.sample()</p></li>
</ul>
</p></li>
<li><p><strong>linestyles</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line style (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>linewidths</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line width (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>colors</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the color (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>cv1_lims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of CV1. If None, no limits are enforced</p></li>
<li><p><strong>cv2_lims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of CV2. If None, no limits are enforced</p></li>
<li><p><strong>flims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the free energy. If None, no limits are enforced</p></li>
<li><p><strong>ncolors</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=8</em>) – only relevant for 2D contour plot, represents the number of contours (and hence colors) to be used in plot.</p></li>
<li><p><strong>plot_additional_function_contours</strong> (<em>[</em><em>callable</em><em>, </em><em>list</em><em>(</em><em>float</em><em>)</em><em>]</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – allows to specify function f(CV1,CV2) and a list of contour values [c_1, c_2, …]. This will add contours of the form <img class="math" src="_images/math/f1c3d87cfb79984dbff983082cdc7bd6085273c7.png" alt="f(CV1,CV2)=c_i"/> to the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_average">
<span class="sig-name descname"><span class="pre">project_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.project_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_average" title="Permalink to this definition"></a></dt>
<dd><p>Construct a 1D free energy profile representing the projection of the 2D free energy surface F2(CV1,CV2) onto the average q=(CV1+CV2)/2 of the collective variables using the following formula:</p>
<div class="math">
<p><img src="_images/math/01e1f051a64cfd38231cdeafeb1e1362a3ca07d4.png" alt="F1(q) = -k_B T \log\left( 2\int_{-\infty}^{+\infty} e^{-\beta F2(x,2q-x}dx \right)"/></p>
</div><p>with <img class="math" src="_images/math/b6bf4587a143cb309447310b1941af2f202f9a55.png" alt="q=0.5\dot(CV1+CV2)"/>. This routine is a wrapper around the more general <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – width of the single-bin approximation of the delta function applied in the projection formula. The delta function is one whenever abs(function(cv1,cv2)-q)&lt;delta/2. Hence, delta has the same units as the new collective variable q. If None, the average bin width of the new CV is used.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit for the new CV for plotting and printing purposes</p></li>
<li><p><strong>return_class</strong> (<em>python class object</em><em>, </em><em>optional</em><em>, </em><em>default=BaseFreeEnergyProfile</em>) – The class of which an instance will finally be returned.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, the default of the <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>projected 1D free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see return_class argument</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_cv1">
<span class="sig-name descname"><span class="pre">project_cv1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.project_cv1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_cv1" title="Permalink to this definition"></a></dt>
<dd><p>Construct a 1D free energy profile representing the projection of the 2D free energy surface F2(CV1,CV2) onto q=CV1 using the formula:</p>
<div class="math">
<p><img src="_images/math/88c5abe93d4e8fb02cab50ef3a011a507b865836.png" alt="F1(q) = -k_B T \log\left( \int_{-\infty}^{+\infty} e^{-\beta F2(q,y}dy \right)"/></p>
</div><p>with <img class="math" src="_images/math/1751eebf30d9505a477dd32bcb1fa7881c41dc33.png" alt="q=CV1"/>. This routine is a wrapper around the more general <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – width of the single-bin approximation of the delta function applied in the projection formula. The delta function is one whenever abs(function(cv1,cv2)-q)&lt;delta/2. Hence, delta has the same units as the new collective variable q. If None, the average bin width of the new CV is used.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit for the new CV for printing and plotting purposes</p></li>
<li><p><strong>return_class</strong> (<em>python class object</em><em>, </em><em>optional</em><em>, </em><em>default=BaseFreeEnergyProfile</em>) – The class of which an instance will finally be returned.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, the default of the <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>projected 1D free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see return_class argument</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_cv2">
<span class="sig-name descname"><span class="pre">project_cv2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.project_cv2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_cv2" title="Permalink to this definition"></a></dt>
<dd><p>Construct a 1D free energy profile representing the projection of the 2D FES F2(CV1,CV2) onto q=CV2. This is implemented as follows:</p>
<blockquote>
<div><p>F1(q) = -k_B T logleft( int_{-infty}^{+infty} e^{-beta F2(x,q}dx right)</p>
</div></blockquote>
<p>with <img class="math" src="_images/math/7c7e2ec4e78c0b8d1194abae87aa0376ceef4b2d.png" alt="q=CV2"/>. This routine is a wrapper around the more general <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – width of the single-bin approximation of the delta function applied in the projection formula. The delta function is one whenever abs(function(cv1,cv2)-q)&lt;delta/2. Hence, delta has the same units as the new collective variable q. If None, the average bin width of the new CV is used.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit for the new CV for printing and plotting purposes</p></li>
<li><p><strong>return_class</strong> (<em>python class object</em><em>, </em><em>optional</em><em>, </em><em>default=BaseFreeEnergyProfile</em>) – The class of which an instance will finally be returned.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, the default of the <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>projected 1D free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see return_class argument</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_difference">
<span class="sig-name descname"><span class="pre">project_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sign=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.project_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_difference" title="Permalink to this definition"></a></dt>
<dd><p>Construct a 1D free energy profile representing the projection of the 2D FES onto the difference of collective variables using the following formula:</p>
<div class="math">
<p><img src="_images/math/0b312d1a0b872af58ead0c5fe487802ab2df249f.png" alt="F1(q) = -k_B T \log\left( \int_{-\infty}^{+\infty} e^{-\beta F2(x,x+q)}dx \right)"/></p>
</div><p>with <img class="math" src="_images/math/4fbd31c2f94874b3643015152c7e9b6dd2078674.png" alt="q=CV2-CV1"/>. This routine is a wrapper around the more general <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sign</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – If sign is set to 1, the projection is done on q=CV2-CV1, if it is set to -1, projection is done to q=CV1-CV2 instead</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – width of the single-bin approximation of the delta function applied in the projection formula. The delta function is one whenever abs(function(cv1,cv2)-q)&lt;delta/2. Hence, delta has the same units as the new collective variable q. If None, the average bin width of the new CV is used.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit for the new CV for printing and plotting purposes</p></li>
<li><p><strong>return_class</strong> (<em>python class object</em><em>, </em><em>optional</em><em>, </em><em>default=BaseFreeEnergyProfile</em>) – The class of which an instance will finally be returned.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, the default of the <a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_function</span></code></a> is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>projected 1D free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see return_class argument</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if an invalid value for sign is given.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function">
<span class="sig-name descname"><span class="pre">project_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label='CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.project_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.project_function" title="Permalink to this definition"></a></dt>
<dd><p>Routine to implement the general projection of a 2D FES onto a collective variable defined by the given function (which takes the original two CVs as arguments).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<em>callable</em>) – function in terms of the original CVs to define the new CV to project upon</p></li>
<li><p><strong>qs</strong> (<em>np.ndarray</em>) – grid for the new CV</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – width of the single-bin approximation of the delta function applied in the projection formula. The delta function is one whenever abs(function(cv1,cv2)-q)&lt;delta/2. Hence, delta has the same units as the new collective variable q. If None, the average bin width of the new CV is used.</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label for the new CV</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit for the new CV for printing and plotting purposes</p></li>
<li><p><strong>return_class</strong> (<em>python class object</em><em>, </em><em>optional</em><em>, </em><em>default=BaseFreeEnergyProfile</em>) – The class of which an instance will finally be returned</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, propagator is initialized as Propagator(target_distribution=self.error.__class__, samples_are_flattened=True) where self.error.__class__ indicates the distribution of the error on the 2D FES itself, and ncycles is set to ncycles_default defined in the <a class="reference internal" href="rg_error.html#module-thermolib.error" title="thermolib.error"><code class="xref py py-mod docutils literal notranslate"><span class="pre">error</span></code></a> module.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>projected 1D free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>see return_class argument</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.recollect">
<span class="sig-name descname"><span class="pre">recollect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1s_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2s_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_new_fes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.recollect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.recollect" title="Permalink to this definition"></a></dt>
<dd><p>Redefine the CV1 and CV2 grids to the given new arrays. For each new (CV1,CV2)-bin, collect all free energy values on the original grid that fall within this new bin and make the boltzmann average (disregarding possible nans as part of the average). As such, this routine can be used to (1) coarsen a grid that was originally to fine and/or (2) filter out noise on a given free energy profile by means of averaging. The main part is implemented in the routine <code class="xref py py-meth docutils literal notranslate"><span class="pre">recollect_surface_2d</span></code>, while the current routine serves as a wrapper for proper error propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q1s_new</strong> (<em>np.ndarray</em>) – Array containing grid points for new CV1 grid</p></li>
<li><p><strong>q2s_new</strong> (<em>np.ndarray</em>) – Array containing grid points for new CV2 grid</p></li>
<li><p><strong>interpolate</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to True, apply the <code class="xref py py-meth docutils literal notranslate"><span class="pre">inerpolate_surface_2d</span></code> routine for interpolating fs values that are np.nan using its neighboring values.</p></li>
<li><p><strong>interpolation_depth</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=3</em>) – interpolation_depth parameter parsed to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">inerpolate_surface_2d</span></code> routine. See documentation in that routine for more details.</p></li>
<li><p><strong>return_new_fes</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If set to False, the recollected data will be written to the current instance (overwritting the original data). If set to True, a new instance will be initialized with the recollected data and returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns an instance of the current class if the keyword argument <cite>return_new_fes</cite> is set to True. Otherwise, None is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None or instance of same class as self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.savetxt">
<span class="sig-name descname"><span class="pre">savetxt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn_txt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.savetxt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.savetxt" title="Permalink to this definition"></a></dt>
<dd><p>Save the free energy profile to a txt file using numpy.savetxt. The units in which the CVs and free energy are written is specified in the attributes cv1_output_unit, cv2_output_unit and f_output_unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fn_txt</strong> (<em>str</em>) – name of the file to write fes to</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.set_ref">
<span class="sig-name descname"><span class="pre">set_ref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.set_ref"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.set_ref" title="Permalink to this definition"></a></dt>
<dd><p>Set the energy reference of the free energy surface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ref</strong> (<em>str</em><em>, </em><em>default='min'</em>) – the choice for the energy reference. Currently only one possibility is implemented, i.e. <em>m</em> or <em>min</em> for the global minimum.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>IOError</strong> – if invalid value for keyword argument ref is given. See doc above for choices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.FreeEnergySurface2D.transform_function">
<span class="sig-name descname"><span class="pre">transform_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">functions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">derivatives</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Q1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Q2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#FreeEnergySurface2D.transform_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D.transform_function" title="Permalink to this definition"></a></dt>
<dd><p>Routine to transform the current free energy profile in terms of the original collective variables <img class="math" src="_images/math/922faaf859de513e2b4efd1b78114ae4611ef43b.png" alt="(CV_1,CV_2)"/> towards a free energy profile in terms of new collective variables <img class="math" src="_images/math/cc00bd9c847723534612ceaca220abe8789a6ebe.png" alt="(Q_1,Q_2)"/> according to the given deterministic relation</p>
<div class="math">
<p><img src="_images/math/a4e2d942b2a6c83864294b13c687a3f08da34d31.png" alt="\left\{\begin{array}{rl}
    Q_1 &amp;= f_1(CV_1,CV_2) \\
    Q_2 &amp;= f_2(CV_1,CV_2) \\
\end{array}\right. \Leftrightarrow \left\{\begin{array}{rl}
    CV_1 &amp;= H_1(Q_1,Q_2) \\
    CV_2 &amp;= H_2(Q_1,Q_2) \\
\end{array}\right."/></p>
</div><p>with <img class="math" src="_images/math/6cf61beb6a6b2a943b1d37155bca9255fa2b1ee6.png" alt="(H_1,H_2)"/> the inverse of <img class="math" src="_images/math/642c5180873b3727f0fae19e6d6d19a771e54b22.png" alt="(f_1,f_2)"/>. The transformed free energy surface <img class="math" src="_images/math/00ea8eca58048b564c2e821940bb7ac5d57102be.png" alt="F_Q(Q_1,Q_2)"/> is given by:</p>
<div class="math">
<p><img src="_images/math/759292a6cc8e2254b886ab9620800cd5433f2f27.png" alt="F_Q(Q_1,Q_1) &amp;= F_{CV}(H_1(Q_1,Q_2),H_2(Q_1,Q_2)) + k_B T \log\left[J\left(H_1(Q_1,Q_2),H_2(Q_1,Q_2)\right)\right]"/></p>
</div><p>where <img class="math" src="_images/math/db9b01f420b027b0fafb8c71ea9297b2d4403dd5.png" alt="J(CV_1,CV_2)"/> represents the Jacobian determinant of the transformation:</p>
<div class="math">
<p><img src="_images/math/1086305320dba7033e0f14e7af06dc28bae0c219.png" alt="J(CV_1,CV_2) = \left|\begin{array}{cc}
                    \frac{\partial f_1}{\partial CV_1} &amp; \frac{\partial f_1}{\partial CV_2} \\
                    \frac{\partial f_2}{\partial CV_1} &amp; \frac{\partial f_2}{\partial CV_2} \\
                    \end{array}\right| \\
            = \frac{\partial f_1}{\partial CV_1}\cdot\frac{\partial f_2}{\partial CV_2} - \frac{\partial f_2}{\partial CV_1}\cdot\frac{\partial f_1}{\partial CV_2}"/></p>
</div><p>Depending on the size of your grid, this routine might take several minutes in case an error bar was included in the original FES and hence needs to be propagated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>functions</strong> (<em>callable</em>) – The transformation functions <img class="math" src="_images/math/0464a071da3203b9d565701f510a766ae52f3016.png" alt="f_1"/> and <img class="math" src="_images/math/8bba708bfd9e1df2575d817c79ab6ae0139b20c6.png" alt="f_2"/> from the equations above.</p></li>
<li><p><strong>q1s</strong> (<em>np.ndarray</em>) – array of grid points of the new collective variable <img class="math" src="_images/math/dbcd9ce527c920ea69d4260d447232da34ba310f.png" alt="Q_1"/></p></li>
<li><p><strong>q2s</strong> (<em>np.ndarray</em>) – array of grid points of the new collective variable <img class="math" src="_images/math/fa05a3fda3ab7d7ee4b879c770f7d84e2afbc5f1.png" alt="Q_2"/></p></li>
<li><p><strong>derivatives</strong> (<em>callable</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – The analytical derivatives of the transformation functions <img class="math" src="_images/math/0464a071da3203b9d565701f510a766ae52f3016.png" alt="f_1"/> and <img class="math" src="_images/math/8bba708bfd9e1df2575d817c79ab6ae0139b20c6.png" alt="f_2"/>. Should be given as a list <img class="math" src="_images/math/3353167eb968a9a56bc23505a997be7f7b62f139.png" alt="[[\frac{\partial f_1}{\partial CV_1},\frac{\partial f_1}{\partial CV_2}],[\frac{\partial f_2}{\partial CV_1},\frac{\partial f_2}{\partial CV_2}]]"/>. If set to None, the derivatives will be estimated through numerical differentiation.</p></li>
<li><p><strong>interpolate</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – If set to True, perform a interpolation using the <a class="reference internal" href="rg_tools.html#thermolib.tools.interpolate_surface_2d" title="thermolib.tools.interpolate_surface_2d"><code class="xref py py-meth docutils literal notranslate"><span class="pre">interpolate_surface_2d</span></code></a> (see documentation there for more info).</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=None) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken). If set to None, propagator is initialized as Propagator(target_distribution=self.error.__class__, flattener=Flattener(len(q1s),len(q2s)), samples_are_flattened=False) where self.error.__class__ indicates the distribution of the error on the 2D FES itself, and ncycles is set to ncycles_default defined in the <a class="reference internal" href="rg_error.html#module-thermolib.error" title="thermolib.error"><code class="xref py py-mod docutils literal notranslate"><span class="pre">error</span></code></a> module. Beware that even if a custom propagator is parsed, its attributes flattener and samples_are_flattened will be overwritten with Flattener(len(q1s),len(q2s)) and False respectively for proper functioning.</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='Q1'</em>) – The label of the new first collective variable used in plotting etc</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='Q2'</em>) – The label of the new second collective variable used in plotting etc</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>The unit of the new first collective varaible used in plotting and printing. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>The unit of the new second collective varaible used in plotting and printing. Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>transformed free energy profile</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>the same class as the instance this routine is called upon</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.fep.</span></span><span class="sig-name descname"><span class="pre">SimpleFreeEnergyProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'F'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile" title="Permalink to this definition"></a></dt>
<dd><p>Class implementing a ‘simple’ 1D FEP representing a bi-stable profile with 2 minima corresponding to the reactant and process states and 1 local maximum corresponding to the transition state. As such, this class offers all features of the parent class <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a> as well as the functionality implemented in <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_states</span></code></a> to automatically define the macrostates corresponding to reactant state and product state as well as the microstate corresponding to the transition state.</p>
<p>See documentation of <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.from_base">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.from_base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.from_base" title="Permalink to this definition"></a></dt>
<dd><p>Simple class method to transform a given instance of BaseFreeEnergyProfile into an instance of SimpleFreeEnergyProfile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code>) – instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code> to convert into an instance of <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'thermo_kinetic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvlims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">micro_linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'--'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">macro_linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">macro_color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_latex</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the property stored in the current profile as function of the CV. If the error distribution is stored in self.error, various statistical quantities besides the mean (such as the error width, lower/upper limit on the error bar, random sample) can be plotted using the <code class="docutils literal notranslate"><span class="pre">obss</span></code> keyword. Alternatively, one can also plot the thermodynamic micro/macrostates (defined by <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">process_states()</span></code></a>) and optionally the kinetic properties such as the rate constant and phenomenological barrier (see obss and rate keywords in the documentation below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of a file to save plot to. If None, the plot will not be saved to a file.</p></li>
<li><p><strong>obss</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default='thermo_kinetic'</em>) – <p>Specify which statistical property/properties to plot. Multiple values from the list given below are allowed, which will be plotted on the same figure. Alternatively, one can also specify <cite>obss=thermo_kinetic</cite> which will plot the free energy profile, its error as well as highlight all micro and macrostates defined in the current instance.</p>
<ul>
<li><p><strong>value</strong> - the values stored in self.fs</p></li>
<li><p><strong>mean</strong> - the mean according to the error distribution, i.e. self.error.mean()</p></li>
<li><p><strong>lower</strong> - the lower limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[0]</p></li>
<li><p><strong>upper</strong> - the upper limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[1]</p></li>
<li><p><strong>error</strong> - half the width of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. abs(upper-lower)/2</p></li>
<li><p><strong>sample</strong> - a random sample taken from the error distribution</p></li>
</ul>
</p></li>
<li><p><strong>rate</strong> (<a class="reference internal" href="rg_kin.html#thermolib.kinetics.rate.RateFactorEquilibrium" title="thermolib.kinetics.rate.RateFactorEquilibrium"><code class="xref py py-class docutils literal notranslate"><span class="pre">RateFactorEquilibrium</span></code></a> or None, optional, default=None) – only relevent when <code class="docutils literal notranslate"><span class="pre">obss=thermo_kinetic</span></code>, rate factor that allows to include inclusion of reaction rate and phenomenological free energy barriers to plot</p></li>
<li><p><strong>micro_marker</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='s'</em>) – matplotlib marker style for indicating microstates</p></li>
<li><p><strong>micro_color</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='r'</em>) – matplotlib marker color for indicating microstates</p></li>
<li><p><strong>micro_size</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=4</em>) – matplotlib marker size for indicating microstates</p></li>
<li><p><strong>macro_linestyle</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='-'</em>) – matplotlib line style for indicating macrostates</p></li>
<li><p><strong>macro_color</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='b'</em>) – matplotlib line color for indicating macrostates</p></li>
<li><p><strong>linestyles</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line style (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>linewidths</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line width (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>colors</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the color (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>cvlims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the cv. If None, no limits are enforced</p></li>
<li><p><strong>flims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the X property. If None, no limits are enforced</p></li>
<li><p><strong>do_latex</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – only relevent when <code class="docutils literal notranslate"><span class="pre">obss=thermo_kinetic</span></code>, will format the numerical values on the side of the plot in LaTeX.</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – If True, the legend is shown in the plot</p></li>
<li><p><strong>fig_size</strong> (<em>list</em><em> of </em><em>two floats</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – specify the matplotlib figure siz</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the <code class="docutils literal notranslate"><span class="pre">obs</span></code> argument contains an invalid specification</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.print_states">
<span class="sig-name descname"><span class="pre">print_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.print_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.print_states" title="Permalink to this definition"></a></dt>
<dd><p>Print information on the micro- and macrostates currently defined</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states">
<span class="sig-name descname"><span class="pre">process_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">lims=[-inf,</span> <span class="pre">None,</span> <span class="pre">None,</span> <span class="pre">inf],</span> <span class="pre">verbose=False,</span> <span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.process_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.process_states" title="Permalink to this definition"></a></dt>
<dd><p>Routine to define:</p>
<blockquote>
<div><ul class="simple">
<li><p>a microstate representig the transition state (ts) as the local maximum within the given ts_range</p></li>
<li><p>a microstate representing the reactant (r) as local minimum left of ts</p></li>
<li><p>a microstate representing the product (p) as local minimum right of ts</p></li>
<li><p>a macrostate representing the reactant (R) as an integrated sum of microstates left of the ts</p></li>
<li><p>a macrostate representing the product (P) as an integrated sum of microstates right of the ts</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lims</strong> (<em>list</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-np.inf</em><em>,</em><em>None</em><em>, </em><em>None</em><em>, </em><em>np.inf</em><em>]</em>) – list of 4 values [a,b,c,d] such that the reactant state minimum (r) should be within interval [a,b], the transition state maximum (ts) should be within interval [b,c] and the the product state minimum (p) should be within interval [c,d]. If b and c are both None, the transition state maximum is looked for in the entire range defined by [a,b] (which will fail if the transition state is only a local maximum but not the global maximum in that range). a can be specified as -np.inf and/or b can be specified as np.inf indicating no limits.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, increase verbosity and print thermodynamic state properties</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if one of b,c is None, but not both</p></li>
<li><p><strong>AssertionError</strong> – by a <code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code> child classes if it could not determine its micro/macrostate</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.set_ref">
<span class="sig-name descname"><span class="pre">set_ref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'min'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.set_ref"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.set_ref" title="Permalink to this definition"></a></dt>
<dd><p>Set the energy reference of the free energy profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ref</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=min</em>) – <p>the choice for the energy reference, should be one of:</p>
<ul class="simple">
<li><p><em>m</em> or <em>min</em> for the global minimum</p></li>
<li><p><em>r</em> or <em>reactant</em> for the reactant minimum</p></li>
<li><p><em>ts</em>, <em>trans_state</em> or <em>transition</em> for the transition state maximum</p></li>
<li><p><em>p</em> or <em>product</em> for the product minimum</p></li>
</ul>
<p>The options r, ts and p are only available if the reactant, transition state and product have already been found by the routine process_states.</p>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>IOError</strong> – invalid value for keyword argument ref is given. See doc above for choices.</p></li>
<li><p><strong>AssertionError</strong> – if a microstate is not defined while the ref choice requires it</p></li>
<li><p><strong>AssertionError</strong> – if the ref choice was set to min or max, but the global minimum/maximum could not be found</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.update_states">
<span class="sig-name descname"><span class="pre">update_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#SimpleFreeEnergyProfile.update_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile.update_states" title="Permalink to this definition"></a></dt>
<dd><p>Routine to update the state definition. Usefull if the free energy profile has changed somehow.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thermolib.thermodynamics.fep.plot_profiles">
<span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.fep.</span></span><span class="sig-name descname"><span class="pre">plot_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_latex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/fep.html#plot_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.fep.plot_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Make a plot to compare multiple 1D free energy profiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profiles</strong> (list of <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a> or child classes) – list of profiles to plot</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – file name to save the figure to. If None, the plot will not be saved.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – list of labels for the legend. Order is assumed to be consistent with profiles.</p></li>
<li><p><strong>flims</strong> (<em>list/np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – [lower,upper] limits of the free energy axis in plots.</p></li>
<li><p><strong>colors</strong> – <p>List of matplotlib color definitions for each entry in profile. If an entry is None, a color will be chosen internally. If colors=None, implying all colors are chosen internally.
:type colors: List(str), optional, default=None</p>
<dl class="field-list simple">
<dt class="field-odd">param linestyles<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of matplotlib line style definitions for each entry in histograms. If an entry is None, the default line style of ‘-’ will be chosen . If linestyles=None, implying all line styles are set to the default of ‘-‘.</p>
</dd>
<dt class="field-even">type linestyles<span class="colon">:</span></dt>
<dd class="field-even"><p>List(str), optional, default=None</p>
</dd>
<dt class="field-odd">param linewidths<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of matplotlib line width definitions for each entry in histograms. If an entry is None, the default line width of 1 will be chosen. If linewidths=None, implying all line widths are set to the default of 2.</p>
</dd>
<dt class="field-even">type linewidths<span class="colon">:</span></dt>
<dd class="field-even"><p>List(str), optional, default=None</p>
</dd>
</dl>
</p></li>
<li><p><strong>do_latex</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – Use LaTeX to do formatting of text in plot, requires working LaTeX installation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.histogram">
<span id="histograms-thermolib-thermodynamics-histogram"></span><h2>Histograms – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.histogram</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.histogram" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.histogram.</span></span><span class="sig-name descname"><span class="pre">Histogram1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D" title="Permalink to this definition"></a></dt>
<dd><p>Class representing a 1D probability histogram <img class="math" src="_images/math/e7c993a4284806b9febffa41587624d295fafb70.png" alt="p(CV)"/> in terms of a single collective variable <img class="math" src="_images/math/14f8653cb145d24503ca65a35998301c5a3196fc.png" alt="CV"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cvs</strong> (<em>np.ndarray</em>) – <p>the bin values of the collective variable CV, which should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>ps</strong> (<em>np.ndarray</em>) – <p>the histogram probability values at the given CV values. The probabilities should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>error</strong> (child of <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code>, optional, default=None) – error distribution on the free energy profile</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the units for printing and plotting of CV values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label for the CV for printing and plotting</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.copy" title="Permalink to this definition"></a></dt>
<dd><p>Make and return a copy of the current Histogram1D instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.from_average">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histograms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.from_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.from_average" title="Permalink to this definition"></a></dt>
<dd><p>Start from a set of 1D histograms and compute and return the averaged histogram (and optionally the error bar).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histograms</strong> (list of <a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram1D" title="thermolib.thermodynamics.histogram.Histogram1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram1D</span></code></a> instances) – set of histrograms to be averaged</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – indicate how to perform error analysis. Currently, only one method is supported, ‘std’, which will compute the error bar from the standard deviation within the set of histograms.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – the unit in which cv will be plotted/printed. Defaults to the cv_output_unit of the first histogram given.</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for the new CV. Defaults to the cv_label of the first given histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if the histograms do not have a consistent CV grid</p></li>
<li><p><strong>AssertionError</strong> – if the histograms do not have a consistent CV label</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.from_fep">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_fep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.from_fep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.from_fep" title="Permalink to this definition"></a></dt>
<dd><p>Compute a probability histogram from the given free energy profile at the given temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fep</strong> (<em>fep.BaseFreeEnergyProfile/fep.SimpleFreeEnergyProfile</em>) – free energy profile from which the probability histogram is computed</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which the histogram input data was simulated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.from_single_trajectory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_single_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_p_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.from_single_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.from_single_trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Routine to estimate a 1D probability histogram in terms of a single collective variable from a series of samples of that collective variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – <p>series of samples of the collective variable. Should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>bins</strong> (<em>np.ndarray</em>) – the edges of the bins for which a histogram will be constructed. This argument is parsed to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.histogram.html">the numpy.histogram routine</a>. Hence, more information on its meaning and allowed values can be found there.</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – <p>indicate if and how to perform error analysis. One of following options is available:</p>
<ul>
<li><p><strong>mle_p</strong> - Estimating the error directly for the probability of each bin in the histogram. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_p_cov</strong> - Estimate the full covariance matrix for the probability of all bins in the histogram. In other words, appart from the error on the probability/free energy of a bin itself, we now also account for the covariance between the probabilty/free energy of the bins. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_f</strong> - Estimating the error for minus the logarithm of the probability, which is proportional to the free energy (hence f in mle_f). As the probability is expressed as <img class="math" src="_images/math/fd30f69643ea04ca7c6c456203a0cfd15b0cd92f.png" alt="\propto e^{-f}"/>, its positivity is explicitly accounted for.</p></li>
<li><p><strong>mle_f_cov</strong> - Estimate the full covariance matrix for minus the logarithm of the probability of all bins in the histogram. In other words, appart from the error on the probabilty/free energy of a bin itself (including explicit positivity constraint), we now also account for the covariance between the probability/free energy of the bins.</p></li>
</ul>
</p></li>
<li><p><strong>error_p_threshold</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.0</em>) – only relevant when error estimation is enabled (see parameter <code class="docutils literal notranslate"><span class="pre">error_estimate</span></code>). When <code class="docutils literal notranslate"><span class="pre">error_p_threshold</span></code> is set to x, bins in the histogram for which the probability resulting from the trajectory is smaller than x will be disabled for error estimation (i.e. its error will be set to np.nan). This is similar as the error_p_threshold keyword for the from_wham routine, for which the use is illustrated in <a class="reference internal" href="tut/advanced_projection.html"><span class="doc">one of the tutorial notebooks</span></a>.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which cv will be plotted/printed (not the unit of the input array, that is assumed to be atomic units). If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label of the cv that will be used for plotting and printing</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if no valid error_estimate value is given</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.from_wham">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_wham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrtimes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_p_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_subgrid_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nscf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_thress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.from_wham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.from_wham" title="Permalink to this definition"></a></dt>
<dd><p>Routine that implements the Weighted Histogram Analysis Method (WHAM) for reconstructing the overall 1D probability histogram in terms of collective variable CV from a series of molecular simulations that are (possibly) biased in terms of CV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<em>int</em><em> or </em><em>np.ndarray</em><em>(</em><em>float</em><em>)</em>) – number of bins for the CV grid or array representing the bin edges for th CV grid.</p></li>
<li><p><strong>traj_input</strong> – list of CV trajectories, one for each simulation. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.read_wham_input" title="thermolib.tools.read_wham_input"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_wham_input</span></code></a> routine. The arguments trajectories and biasses should be of the same length.</p></li>
<li><p><strong>biasses</strong> (<em>list</em><em>(</em><em>callable</em><em>)</em>) – list of bias potentials, one for each simulation allowing to compute the bias at a given value of the collective variable in that simulation. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.read_wham_input" title="thermolib.tools.read_wham_input"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_wham_input</span></code></a> routine. The arguments traj_input and biasses should be of the same length.</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which all simulations were performed</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – <p>indicate if and how to perform error analysis. One of following options is available:</p>
<ul>
<li><p><strong>mle_p</strong> - Estimating the error directly for the probability of each bin in the histogram. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_p_cov</strong> - Estimate the full covariance matrix for the probability of all bins in the histogram. In other words, appart from the error on the probability/free energy of a bin itself, we now also account for the covariance between the probabilty/free energy of the bins. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_f</strong> - Estimating the error for minus the logarithm of the probability, which is proportional to the free energy (hence f in mle_f). As the probability is expressed as <img class="math" src="_images/math/fd30f69643ea04ca7c6c456203a0cfd15b0cd92f.png" alt="\propto e^{-f}"/>, its positivity is explicitly accounted for.</p></li>
<li><p><strong>mle_f_cov</strong> - Estimate the full covariance matrix for minus the logarithm of the probability of all bins in the histogram. In other words, appart from the error on the probabilty/free energy of a bin itself (including explicit positivity constraint), we now also account for the covariance between the probability/free energy of the bins.</p></li>
</ul>
</p></li>
<li><p><strong>corrtimes</strong> (<em>list</em><em> or </em><em>np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – list of (integrated) correlation times of the CV, one for each simulation. Such correlation times will be taken into account during the error estimation and hence make it more reliable. If set to None, the CV trajectories will be assumed to contain fully uncorrelated samples (which is not true when using trajectories representing each subsequent step from a molecular dynamics simulation). More information can be found in <a class="reference internal" href="ug_error.html#seclab-ug-errorestimation"><span class="std std-ref">the user guide</span></a>. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.decorrelate" title="thermolib.tools.decorrelate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decorrelate</span></code></a> routine. This argument needs to have the same length as the <code class="docutils literal notranslate"><span class="pre">traj_input</span></code> and <code class="docutils literal notranslate"><span class="pre">biasses</span></code> arguments.</p></li>
<li><p><strong>error_p_threshold</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.0</em>) – only relevant when error estimation is enabled (see parameter <code class="docutils literal notranslate"><span class="pre">error_estimate</span></code>). When <code class="docutils literal notranslate"><span class="pre">error_p_threshold</span></code> is set to x, bins in the histogram for which the probability resulting from the trajectory is smaller than x will be disabled for error estimation (i.e. its error will be set to np.nan). It is mainly usefull in the case of 2D histograms,as illustrated in <a class="reference internal" href="tut/advanced_projection.html"><span class="doc">one of the tutorial notebooks</span></a>.</p></li>
<li><p><strong>bias_subgrid_num</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=20</em>) – see documentation for this argument in the <a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_bias" title="thermolib.ext.wham1d_bias"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wham1d_bias</span></code></a> routine</p></li>
<li><p><strong>Nscf</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1000</em>) – the maximum number of steps in the self-consistent loop to solve the WHAM equations</p></li>
<li><p><strong>convergence</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1e-6</em>) – convergence criterium for the WHAM self consistent solver. The SCF loop will stop whenever the integrated absolute difference between consecutive probability densities is less then the specified value.</p></li>
<li><p><strong>bias_thress</strong> – see documentation for the threshold argument in the <a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_bias" title="thermolib.ext.wham1d_bias"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wham1d_bias</span></code></a> routine</p></li>
<li><p><strong>verbosity</strong> – controls the level of verbosity for logging during the WHAM algorithm.</p></li>
<li><p><strong>cv_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which cv will be plotted/printed. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – the label of the cv that will be used on plots</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if traj_input and biasses are not of equal length</p></li>
<li><p><strong>AssertionError</strong> – if traj_input has an element that is not a numpy.ndarray</p></li>
<li><p><strong>AssertionError</strong> – if the CV grid defined by bins argument does not have a uniform spacing.</p></li>
<li><p><strong>ValueError</strong> – if an invalid definition for error_estimate is provided</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.from_wham_c">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_wham_c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_subgrid_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nscf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.from_wham_c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.from_wham_c" title="Permalink to this definition"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version v1.7: </span>This routine sole purpose is backward compatibility and serves as an alias for from_wham. Please start using the from_wham routine as this routine will be removed in the near future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['value']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cvlims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.plot" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Plot the probability histogram as function of the CV. If the error distribution is stored in self.error, various statistical quantities besides the estimated mean probabilty ietsel (such as the error width, lower/upper limit on the error bar, random sample) can be plotted using the <code class="docutils literal notranslate"><span class="pre">obss</span></code> keyword. You can specify additional matplotlib keyword arguments that will be parsed to the matplotlib plotter (<cite>plot</cite> and/or <cite>fill_between</cite>) at the end of the argument list of this routine.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of a file to save plot to. If None, the plot will not be saved to a file.</p></li>
<li><p><strong>obss</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>'value'</em><em>]</em>) – <p>Specify which statistical property/properties to plot. Multiple values are allowed, which will be plotted on the same figure. Following options are supported:</p>
<ul>
<li><p><strong>value</strong> - the values stored in self.ps</p></li>
<li><p><strong>mean</strong> - the mean according to the error distribution, i.e. self.error.mean()</p></li>
<li><p><strong>lower</strong> - the lower limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[0]</p></li>
<li><p><strong>upper</strong> - the upper limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[1]</p></li>
<li><p><strong>error</strong> - half the width of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. abs(upper-lower)/2</p></li>
<li><p><strong>sample</strong> - a random sample taken from the error distribution, i.e. self.error.sample()</p></li>
</ul>
</p></li>
<li><p><strong>linestyles</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line style (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, all linestyles are set to ‘-’</p></li>
<li><p><strong>linewidths</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line width (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, al linewidths are set to 1</p></li>
<li><p><strong>colors</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the color (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>cvlims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the cv. If None, no limits are enforced</p></li>
<li><p><strong>plims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the probability. If None, no limits are enforced</p></li>
<li><p><strong>show_legend</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – If True, the legend is shown in the plot</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if the <code class="docutils literal notranslate"><span class="pre">obs</span></code> argument contains an invalid specification</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.plower">
<span class="sig-name descname"><span class="pre">plower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.plower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.plower" title="Permalink to this definition"></a></dt>
<dd><p>Return the lower limit of an n-sigma error bar on the histogram probability, i.e. <img class="math" src="_images/math/3276b7139ebcf34cc3889ec6c7513b7cab9b44af.png" alt="\mu - n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the lower limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram1D.pupper">
<span class="sig-name descname"><span class="pre">pupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram1D.pupper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram1D.pupper" title="Permalink to this definition"></a></dt>
<dd><p>Return the upper limit of an n-sigma error bar on the histogram probability, i.e. <img class="math" src="_images/math/02e68f36c49d38f9917878ab017c3dcb1207cac4.png" alt="\mu + n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the upper limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.histogram.</span></span><span class="sig-name descname"><span class="pre">Histogram2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D" title="Permalink to this definition"></a></dt>
<dd><p>Class representing a 2D probability histogram <img class="math" src="_images/math/64fb75c3632427dc9745dc390467d26ee7361109.png" alt="p(CV1,CV2)"/> in terms of two collective variable <img class="math" src="_images/math/a577d0fe79effb80a59cd8fc8234b79c930e1201.png" alt="CV1"/> and <img class="math" src="_images/math/5940f136fa69c3c5b1fc9736f991d41f63a4fa65.png" alt="CV2"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1s</strong> – <p>the bin values of the first collective variable CV1, which should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2s</strong> – <p>the bin values of the second collective variable CV2, which should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>ps</strong> – <p>2D array corresponding to  the histogram probability values at the given CV1,CV2 grid. The probabilities should be in atomic units! If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>error</strong> (child of <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code>, optional, default=None) – error distribution on the free energy profile</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the units for printing and plotting of CV1 values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the units for printing and plotting of CV2 values (not the unit of the input array, that is assumed to be in atomic units). Units are defined using the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – label for CV1 for printing and plotting</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2</em>) – label for CV2 for printing and plotting</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.average_cv_constraint_other">
<span class="sig-name descname"><span class="pre">average_cv_constraint_other</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_distribution=&lt;class</span> <span class="pre">'thermolib.error.MultiGaussianDistribution'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.average_cv_constraint_other"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.average_cv_constraint_other" title="Permalink to this definition"></a></dt>
<dd><p>Routine to compute a profile representing the average of one CV (denoted as y/Y below, y for integration values and Y for resulting averaged values) as function of the other CV (denoted as x below), i.e. the other CV is contraint to one of its bin values x. This is done using the following formula:</p>
<div class="math">
<p><img src="_images/math/74f8c37758cdaf5f58b96759e58f0ed462a9f405.png" alt="Y(x) = \frac{\int y\cdot p(x,y) dy}{\int p(x,y)dy}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em> (</em><em>1</em><em> or </em><em>2</em><em>)</em>) – the index of the CV which will be averaged (the other is then contraint). If index=1, then y=CV1 and x=CV2, while if index=2, then y=CV2 and x=CV1.</p></li>
<li><p><strong>target_distribution</strong> (child instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code>, optional, default= <a class="reference internal" href="rg_error.html#thermolib.error.MultiGaussianDistribution" title="thermolib.error.MultiGaussianDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiGaussianDistribution</span></code></a>) – model for the error distribution of the resulting profile.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Profile of the average</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if index is not 1 or 2</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.copy" title="Permalink to this definition"></a></dt>
<dd><p>Make and return a copy of the current 2D probability histogram.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.from_average">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histograms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.from_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.from_average" title="Permalink to this definition"></a></dt>
<dd><p>Start from a set of 2D histograms and compute and return the averaged histogram (and optionally the error bar).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histograms</strong> (list of <a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram1D" title="thermolib.thermodynamics.histogram.Histogram1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram1D</span></code></a> instances) – set of histrograms to be averaged</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – indicate how to perform error analysis. Currently, only one method is supported, ‘std’, which will compute the error bar from the standard deviation within the set of histograms.</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – the unit in which the new CV1 will be plotted/printed. Defaults to the cv1_output_unit of the first histogram given.</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em>) – the unit in which the new CV2 will be plotted/printed. Defaults to the cv2_output_unit of the first histogram given.</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for the new CV1. Defaults to the cv1_label of the first given histogram.</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for the new CV2. Defaults to the cv2_label of the first given histogram.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if the histograms do not have a consistent CV1 grid</p></li>
<li><p><strong>AssertionError</strong> – if the histograms do not have a consistent CV2 grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.from_fes">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_fes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.from_fes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.from_fes" title="Permalink to this definition"></a></dt>
<dd><p>Compute a probability histogram from the given free energy surface at the given temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fes</strong> (<a class="reference internal" href="#thermolib.thermodynamics.fep.FreeEnergySurface2D" title="thermolib.thermodynamics.fep.FreeEnergySurface2D"><em>fep.FreeEnergySurface2D</em></a>) – free energy surfave from which the probability histogram is computed</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which the histogram input data was simulated</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.from_single_trajectory">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_single_trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.from_single_trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.from_single_trajectory" title="Permalink to this definition"></a></dt>
<dd><p>Routine to estimate a 2D probability histogram in terms of two collective variable from a series of samples of those two collective variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Nsamples</em><em>,</em><em>2</em><em>]</em><em>)</em>) – array representing series of samples of the two collective variables. The first column is assumed to correspond to the first collective variable, the second column to the second CV.</p></li>
<li><p><strong>bins</strong> (<em>np.ndarray</em>) – array representing the edges of the bins for which a histogram will be constructed. This argument is parsed to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.histogram.html">the numpy.histogram2d routine</a>. Hence, more information on its meaning and allowed values can be found there.</p></li>
</ul>
</dd>
</dl>
<p>param error_estimate: indicate if and how to perform error analysis. One of following options is available:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>mle_p</strong> - Estimating the error directly for the probability of each bin in the histogram. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_f</strong> - Estimating the error for minus the logarithm of the probability, which is proportional to the free energy (hence f in mle_f). As the probability is expressed as <img class="math" src="_images/math/fd30f69643ea04ca7c6c456203a0cfd15b0cd92f.png" alt="\propto e^{-f}"/>, its positivity is explicitly accounted for.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which CV1 will be plotted/printed (not the unit of the input array, that is assumed to be atomic units). If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which CV2 will be plotted/printed (not the unit of the input array, that is assumed to be atomic units). If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – label of CV1 that will be used for plotting and printing</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2'</em>) – label of CV2 that will be used for plotting and printing</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if no valid error_estimate value is given</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.from_wham">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_wham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traj_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_p_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrtimes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_subgrid_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nscf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_thress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overflow_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.from_wham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.from_wham" title="Permalink to this definition"></a></dt>
<dd><p>Routine that implements the Weighted Histogram Analysis Method (WHAM) for reconstructing the overall 2D probability histogram in terms of two collective variables CV1 and CV2 from a series of molecular simulations that are (possibly) biased in terms of CV1 and/or CV2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bins</strong> (<em>np.ndarray</em>) – list of the form [bins1, bins2] where bins1 and bins2 are numpy arrays each representing the bin edges of their corresponding CV for which a histogram will be constructed. For example the following definition:  [np.arange(-1,1.05,0.05), np.arange(0,5.1,0.1)] will result in a 2D histogram with bins of width 0.05 between -1 and 1 for CV1 and bins of width 0.1 between 0 and 5 for CV2.</p></li>
<li><p><strong>traj_input</strong> – list of [CV1,CV2] trajectories, one for each simulation. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.read_wham_input" title="thermolib.tools.read_wham_input"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_wham_input</span></code></a> routine. The arguments trajectories and biasses should be of the same length.</p></li>
<li><p><strong>biasses</strong> (<em>list</em><em>(</em><em>callable</em><em>)</em>) – list of bias potentials, one for each simulation allowing to compute the bias at given values of the collective variables CV1 and CV2 in that simulation. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.read_wham_input" title="thermolib.tools.read_wham_input"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_wham_input</span></code></a> routine. The arguments traj_input and biasses should be of the same length.</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – the temperature at which all simulations were performed</p></li>
<li><p><strong>pinit</strong> (<em>np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – initial guess for the probability density, which is assumed to be in the ‘xy’-indexing convention (see the “indexing” argument and the corresponding “Notes” section in <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html">the numpy online documentation of the meshgrid routine</a>). If None is given, a uniform distribution is used as initial guess.</p></li>
<li><p><strong>error_estimate</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – <p>indicate if and how to perform error analysis. One of following options is available:</p>
<ul>
<li><p><strong>mle_p</strong> - Estimating the error directly for the probability of each bin in the histogram. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_p_cov</strong> - Estimate the full covariance matrix for the probability of all bins in the histogram. In other words, appart from the error on the probability/free energy of a bin itself, we now also account for the covariance between the probabilty/free energy of the bins. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_f</strong> - Estimating the error for minus the logarithm of the probability, which is proportional to the free energy (hence f in mle_f). As the probability is expressed as <img class="math" src="_images/math/fd30f69643ea04ca7c6c456203a0cfd15b0cd92f.png" alt="\propto e^{-f}"/>, its positivity is explicitly accounted for.</p></li>
<li><p><strong>mle_f_cov</strong> - Estimate the full covariance matrix for minus the logarithm of the probability of all bins in the histogram. In other words, appart from the error on the probabilty/free energy of a bin itself (including explicit positivity constraint), we now also account for the covariance between the probability/free energy of the bins.</p></li>
</ul>
</p></li>
<li><p><strong>error_p_threshold</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.0</em>) – only relevant when error estimation is enabled (see parameter <code class="docutils literal notranslate"><span class="pre">error_estimate</span></code>). When <code class="docutils literal notranslate"><span class="pre">error_p_threshold</span></code> is set to x, bins in the histogram for which the probability resulting from the trajectory is smaller than x will be disabled for error estimation (i.e. its error will be set to np.nan). Its use is illustrated in <a class="reference internal" href="tut/advanced_projection.html"><span class="doc">one of the tutorial notebooks</span></a>.</p></li>
<li><p><strong>corrtimes</strong> (<em>list</em><em> or </em><em>np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – list of (integrated) correlation times of the CVs, one for each simulation. Such correlation times will be taken into account during the error estimation and hence make it more reliable. If set to None, the CV trajectories will be assumed to contain fully uncorrelated samples (which is not true when using trajectories representing each subsequent step from a molecular dynamics simulation). More information can be found in <a class="reference internal" href="ug_error.html#seclab-ug-errorestimation"><span class="std std-ref">the user guide</span></a>. This input can be generated using the <a class="reference internal" href="rg_tools.html#thermolib.tools.decorrelate" title="thermolib.tools.decorrelate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decorrelate</span></code></a> routine. This argument needs to have the same length as the <code class="docutils literal notranslate"><span class="pre">traj_input</span></code> and <code class="docutils literal notranslate"><span class="pre">biasses</span></code> arguments.</p></li>
<li><p><strong>bias_subgrid_num</strong> (<em>optional</em><em>, </em><em>defaults to</em><em> [</em><em>20</em><em>,</em><em>20</em><em>]</em>) – see documentation for this argument in the <a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_bias" title="thermolib.ext.wham2d_bias"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wham2d_bias</span></code></a> routine</p></li>
<li><p><strong>Nscf</strong> (<em>int</em><em>, </em><em>defaults to 1000</em>) – the maximum number of steps in the self-consistent loop to solve the WHAM equations</p></li>
<li><p><strong>convergence</strong> (<em>float</em><em>, </em><em>defaults to 1e-6</em>) – convergence criterium for the WHAM self consistent solver. The SCF loop will stop whenever the integrated absolute difference between consecutive probability densities is less then the specified value.</p></li>
<li><p><strong>bias_thress</strong> (<em>double</em><em>, </em><em>optional</em><em>, </em><em>default=1e-3</em>) – see documentation for this argument in the <a class="reference internal" href="rg_ext.html#thermolib.ext.wham1d_bias" title="thermolib.ext.wham1d_bias"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wham1d_bias</span></code></a> routine</p></li>
<li><p><strong>overflow_threshold</strong> (<em>double</em><em>, </em><em>optional</em><em>, </em><em>default=1e-150</em>) – see documentation for this argument in the <a class="reference internal" href="rg_ext.html#thermolib.ext.wham2d_scf" title="thermolib.ext.wham2d_scf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wham2d_scf</span></code></a> routine</p></li>
<li><p><strong>cv1_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which CV1 will be plotted/printed. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv2_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – <p>the unit in which CV2 will be plotted/printed. If you need help properly converting to atomic units, we refer to the molmod <a class="reference external" href="https://molmod.github.io/molmod/reference/const.html#module-molmod.units">units</a> module.</p>
</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – label of CV1 used for plotting and printing</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2'</em>) – label of CV2 used for plotting and printing</p></li>
<li><p><strong>plot_biases</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – if set to True, a 2D plot of the boltzmann factor of the bias integrated over each bin will be made. This routine (mainly) exists for debugging purposes.</p></li>
<li><p><strong>verbosity</strong> – controls the level of verbosity for logging during the WHAM algorithm.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.from_wham_c">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_wham_c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pinit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_subgrid_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nscf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_biases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.from_wham_c"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.from_wham_c" title="Permalink to this definition"></a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version v1.7: </span>This routine sole purpose is backward compatibility and serves as an alias for from_wham. Please start using the from_wham routine as this routine will be removed in the near future.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[slice(None,</span> <span class="pre">None,</span> <span class="pre">None),</span> <span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['value']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.plot" title="Permalink to this definition"></a></dt>
<dd><p>Make either a 2D contour plot of p(CV1,CV2) or a 1D sliced plot of the probability along a slice in the direction specified by the slicer argument. Appart from the value of the probability itself, other (statistical) related properties can be plotted as defined in the obbs argument. At the end of the argument list, you can also specify any matplotlib keyword arguments you wish to parse to the matplotlib plotter. E.g. if you want to specify the colormap, you can just add at the end of the arguments <code class="docutils literal notranslate"><span class="pre">cmap='rainbow'</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – name of a file to save plot to. If None, the plot will not be saved to a file.</p></li>
<li><p><strong>slicer</strong> – <p>determines which degrees of freedom (CV1/CV2) vary/stay fixed in the plot. If slice(none) is specified, the probability will be plotted as function of the corresponding CV. If an integer <cite>i</cite> is specified, that corresponding CV will be kept fixed at its <cite>i-th</cite> value. Some examples:</p>
<ul>
<li><p>[slice(None),slice(Nonne)] – a 2D contour plot will be made of the probability as function of both CVs</p></li>
<li><p>[slice(None),10] – a 1D plot will be made of the probability as function of CV1 with CV2 fixed at self.cv2s[10]</p></li>
<li><p>[23,slice(None)] – a 1D plot will be made of the probability as function of CV2 with CV1 fixed at self.cv1s[23]</p></li>
</ul>
</p></li>
<li><p><strong>obss</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>'value'</em><em>]</em>) – <p>Specify which statistical property/properties to plot. Multiple values are allowed, which will be plotted on the same figure. Following options are supported:</p>
<ul>
<li><p><strong>value</strong> - the values stored in self.ps</p></li>
<li><p><strong>mean</strong> - the mean according to the error distribution, i.e. self.error.mean()</p></li>
<li><p><strong>lower</strong> - the lower limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[0]</p></li>
<li><p><strong>upper</strong> - the upper limit of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. self.error.nsigma_conf_int(2)[1]</p></li>
<li><p><strong>error</strong> - half the width of the 2-sigma error bar (which corresponds to a 95% confidence interval in case of a normal distribution), i.e. abs(upper-lower)/2</p></li>
<li><p><strong>sample</strong> - a random sample taken from the error distribution, i.e. self.error.sample()</p></li>
</ul>
</p></li>
<li><p><strong>linestyles</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line style (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>linewidths</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the line width (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>colors</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Specify the color (using matplotlib definitions) for each quantity requested in <code class="docutils literal notranslate"><span class="pre">obss</span></code>. If None, matplotlib will choose.</p></li>
<li><p><strong>cv1_lims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of CV1. If None, no limits are enforced</p></li>
<li><p><strong>cv2_lims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of CV2. If None, no limits are enforced</p></li>
<li><p><strong>plims</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – limits to the plotting range of the probability. If None, no limits are enforced</p></li>
<li><p><strong>ncolors</strong> – only relevant for 2D contour plot, represents the number of contours (and hence colors) to be used in plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.plower">
<span class="sig-name descname"><span class="pre">plower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.plower"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.plower" title="Permalink to this definition"></a></dt>
<dd><p>Return the lower limit of an n-sigma error bar on the histogram probability, i.e. <img class="math" src="_images/math/3276b7139ebcf34cc3889ec6c7513b7cab9b44af.png" alt="\mu - n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the lower limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.Histogram2D.pupper">
<span class="sig-name descname"><span class="pre">pupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#Histogram2D.pupper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.Histogram2D.pupper" title="Permalink to this definition"></a></dt>
<dd><p>Return the upper limit of an n-sigma error bar on the histogram probability, i.e. <img class="math" src="_images/math/02e68f36c49d38f9917878ab017c3dcb1207cac4.png" alt="\mu + n\sigma"/> with <img class="math" src="_images/math/4a3598141469c2555591e66606a1b86d4ec6dca9.png" alt="\mu"/> the mean and <img class="math" src="_images/math/b52df27bfb0b1e3af0c2c68a7b9da459178c2a7d.png" alt="\sigma"/> the standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsigma</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – defines the n-sigma error bar</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the upper limit of the n-sigma error bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray with dimensions determined by self.error</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – if self.error is not defined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thermolib.thermodynamics.histogram.plot_histograms">
<span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.histogram.</span></span><span class="sig-name descname"><span class="pre">plot_histograms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">histograms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/histogram.html#plot_histograms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.histogram.plot_histograms" title="Permalink to this definition"></a></dt>
<dd><p>Make a plot to compare multiple 1D probability histograms (and possibly teh corresponding free energy profiles)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>histograms</strong> (list of <a class="reference internal" href="#thermolib.thermodynamics.histogram.Histogram1D" title="thermolib.thermodynamics.histogram.Histogram1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Histogram1D</span></code></a> or child classes) – list of histrograms to plot</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – file name to save the figure to. If None, the plot will not be saved.</p></li>
<li><p><strong>temp</strong> (<em>float/list</em><em>(</em><em>float</em><em>)</em><em>/np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – if defined, the free energy profile corresponding to each histogram will be computed and plotted with its corresponding temperature. If a single float is given, all histograms are assumed to be at the same temperature, if a list or array of floats is given, each entry is assumed to be the temperature of the corresponding entry in the input list of histograms.</p></li>
<li><p><strong>labels</strong> (<em>list</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – list of labels for the legend, one for each histogram. Order is assumed to be consistent with profiles.</p></li>
<li><p><strong>flims</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – [lower,upper] limit of the free energy axis in plots. Ignored if temp argument is not given.</p></li>
<li><p><strong>colors</strong> (<em>List</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – List of matplotlib color definitions for each entry in histograms. If an entry is None, a color will be chosen internally. If colors=None, all colors are chosen internally.</p></li>
<li><p><strong>linestyles</strong> (<em>List</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – List of matplotlib line style definitions for each entry in histograms. If an entry is None, the default line style of ‘-’ will be chosen internally. If linestyles=None, all line styles are set to ‘-‘.</p></li>
<li><p><strong>linewidths</strong> (<em>List</em><em>(</em><em>str</em><em>)</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – List of matplotlib line width definitions for each entry in histograms. If an entry is None, the default line width of 1 will be chosen. If linewidths=None, all line widths are set to 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.trajectory">
<span id="trajectory-readers-thermolib-thermodynamics-trajectory"></span><h2>Trajectory readers – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.trajectory</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.trajectory" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.trajectory.ASEExtendedXYZReader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.trajectory.</span></span><span class="sig-name descname"><span class="pre">ASEExtendedXYZReader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/trajectory.html#ASEExtendedXYZReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.trajectory.ASEExtendedXYZReader" title="Permalink to this definition"></a></dt>
<dd><p>Child class of TrajectoryReader to read a series of CVs, defined in keys, from an extended XYZ file using ASE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>list</em>) – list of ASE trajectory info keys to be read from the title of each frame in the XYZ file. For each key defined, the value of frame.info[key] will be extracted from the trajectory constructed with ase.io.read routine.</p></li>
<li><p><strong>units</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – List of units for each CV that needs to be read. If set to [], each CV will be assigned unit ‘au’ (i.e. atomic unit)</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – a name for printing/logging purposes</p></li>
<li><p><strong>start</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – index of starting point in trajectory to extract CV values, can be used to crop out initial equilibration time.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – integer defining how to subsample the trajectory CV data. If set to a value larger than 1, only take sub samples every ‘stride’ steps. If set to 1, sample all trajectory steps. Can be used to decrease correlations between subsequent samples.</p></li>
<li><p><strong>end</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=-1</em>) – index of last trajectory step to be sampled. Can be used to crop out the final part of a simulation trajectory. If set to -1, take all trajectory samples, i.e. no cropping.</p></li>
<li><p><strong>reload</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, the first time the __call__ routine is called, the data that is read/computed from the trajectory will be written in numpy format to a file (with name equal to original trajectory file name appended with ‘.reload’ at the end). The next time the __call__ routine is called again afterwards, the trajectory data will read directly from the .reload file. This results in a considerable speedup in the case the CV is computed from a XYZ trajectory. If False, the data will be read from the trajectory file with every call to the __call__ routine.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, switch on the routine verbosity and print more logging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.trajectory.CVComputer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.trajectory.</span></span><span class="sig-name descname"><span class="pre">CVComputer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">CVs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/trajectory.html#CVComputer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.trajectory.CVComputer" title="Permalink to this definition"></a></dt>
<dd><p>Child class of TrajectoryReader to compute the specified CVs along a given trajectory stored in XYZ or HDF5 files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>CVs</strong> (list of instances from <a class="reference internal" href="#module-thermolib.thermodynamics.cv" title="thermolib.thermodynamics.cv"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cv</span></code></a> module) – a list of collective variable defining how to compute each collective variable along the trajectory</p></li>
<li><p><strong>coords_key</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – This parameter is only relevant when trajectory files require data set names to find the coordinates (i.e. in HDF5 files) and will be ignored otherwise (i.e. if trajectory files are XYZ files). This parameter then defines the location of the coordinates in the trajectory file (e.g. name of coordinates data set in HDF5 file)</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – a name for printing/logging purposes. If None, set to ‘/’-seperated list of the name attributes of the CVs</p></li>
<li><p><strong>start</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – index of starting point in trajectory to extract CV values, can be used to crop out initial equilibration time.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – integer defining how to subsample the trajectory CV data. If set to a value larger than 1, only take sub samples every ‘stride’ steps. If set to 1, sample all trajectory steps. Can be used to decrease correlations between subsequent samples.</p></li>
<li><p><strong>end</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=-1</em>) – index of last trajectory step to be sampled. Can be used to crop out the final part of a simulation trajectory. If set to -1, take all trajectory samples, i.e. no cropping.</p></li>
<li><p><strong>reload</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, the first time the __call__ routine is called, the data that is read/computed from the trajectory will be written in numpy format to a file (with name equal to original trajectory file name appended with ‘.reload’ at the end). The next time the __call__ routine is called again afterwards, the trajectory data will read directly from the .reload file. This results in a considerable speedup in the case the CV is computed from a XYZ trajectory. If False, the data will be read from the trajectory file with every call to the __call__ routine.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, switch on the routine verbosity and print more logging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.trajectory.ColVarReader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.trajectory.</span></span><span class="sig-name descname"><span class="pre">ColVarReader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/trajectory.html#ColVarReader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.trajectory.ColVarReader" title="Permalink to this definition"></a></dt>
<dd><p>Child class of TrajectoryReader to read the CV samples from a COLVAR file. COLVAR files (as used by e.g. Plumed) are just numpy readable text files representing arrays in which the columns represent different CVs and the rows represent the various timesteps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em>) – Represents the indices of the columns in COLVAR file from which to read the CV values.</p></li>
<li><p><strong>units</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – List of units for each CV that needs to be read. If set to [], each CV will be assigned unit ‘au’ (i.e. atomic unit)</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – a name for printing/logging purposes</p></li>
<li><p><strong>start</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – index of starting point in trajectory to extract CV values, can be used to crop out initial equilibration time.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – integer defining how to subsample the trajectory CV data. If set to a value larger than 1, only take sub samples every ‘stride’ steps. If set to 1, sample all trajectory steps. Can be used to decrease correlations between subsequent samples.</p></li>
<li><p><strong>end</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=-1</em>) – index of last trajectory step to be sampled. Can be used to crop out the final part of a simulation trajectory. If set to -1, take all trajectory samples, i.e. no cropping.</p></li>
<li><p><strong>reload</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, the first time the __call__ routine is called, the data that is read/computed from the trajectory will be written in numpy format to a file (with name equal to original trajectory file name appended with ‘.reload’ at the end). The next time the __call__ routine is called again afterwards, the trajectory data will read directly from the .reload file. This results in a considerable speedup in the case the CV is computed from a XYZ trajectory. If False, the data will be read from the trajectory file with every call to the __call__ routine.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, switch on the routine verbosity and print more logging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.trajectory.HDF5Reader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.trajectory.</span></span><span class="sig-name descname"><span class="pre">HDF5Reader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reload</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/trajectory.html#HDF5Reader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.trajectory.HDF5Reader" title="Permalink to this definition"></a></dt>
<dd><p>Child class of TrajectoryReader to read the precomputed CVs from data sets stored in HDF5 file(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>list</em>) – Represent the keys of data sets in HDF5 from which to read CV values.</p></li>
<li><p><strong>units</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – List of units for each CV that needs to be read. If set to [], each CV will be assigned unit ‘au’ (i.e. atomic unit)</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – a name for printing/logging purposes</p></li>
<li><p><strong>start</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – index of starting point in trajectory to extract CV values, can be used to crop out initial equilibration time.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – integer defining how to subsample the trajectory CV data. If set to a value larger than 1, only take sub samples every ‘stride’ steps. If set to 1, sample all trajectory steps. Can be used to decrease correlations between subsequent samples.</p></li>
<li><p><strong>end</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=-1</em>) – index of last trajectory step to be sampled. Can be used to crop out the final part of a simulation trajectory. If set to -1, take all trajectory samples, i.e. no cropping.</p></li>
<li><p><strong>reload</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, the first time the __call__ routine is called, the data that is read/computed from the trajectory will be written in numpy format to a file (with name equal to original trajectory file name appended with ‘.reload’ at the end). The next time the __call__ routine is called again afterwards, the trajectory data will read directly from the .reload file. This results in a considerable speedup in the case the CV is computed from a XYZ trajectory. If False, the data will be read from the trajectory file with every call to the __call__ routine.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, switch on the routine verbosity and print more logging</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.bias">
<span id="bias-potentials-thermolib-thermodynamics-bias"></span><h2>Bias potentials – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.bias</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.bias" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">BiasPotential1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="Permalink to this definition"></a></dt>
<dd><p>Abstract class for 1-dimensional bias potentials. Its inheriting child classes should implement the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> and <code class="docutils literal notranslate"><span class="pre">print_pars</span></code> routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>inverse_cv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If set to True, the CV axix will be inverted prior to bias potential evaluation. WARNING: possible rest value parameters of the potential (such as the rest value of the Parabola1D potential) will not be multiplied with -1!</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential1D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential1D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential1D.plot" title="Permalink to this definition"></a></dt>
<dd><p>Routine to make a plot of the bias potential as function of the CV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cvs</strong> (<em>np.ndarray</em>) – array representing the cv grid on which the bias is evaluated</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – file name to write the plot to. If None, the plot is not written to a file.</p></li>
<li><p><strong>e_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – energy unit in which the bias potential will be plotted</p></li>
<li><p><strong>cv_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the CV will be plotted</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – Label of the CV to be used in the x-label of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential1D.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pars_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential1D.print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="Permalink to this definition"></a></dt>
<dd><p>Routine to return a formatted string defining the current bias for logging purposes. The keywords arguments in <code class="docutils literal notranslate"><span class="pre">pars_units</span></code> are defined in the <code class="docutils literal notranslate"><span class="pre">print_pars</span></code> routine defined in the child classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential1D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pars_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential1D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential1D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine to format a string containing the parameters of the bias for printing/logging purposes. This routine needs to be implemented in each child class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">BiasPotential2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential2D" title="Permalink to this definition"></a></dt>
<dd><p>A base class for 2-dimensional bias potentials. Its inheriting child classes should implement the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> and <code class="docutils literal notranslate"><span class="pre">print_pars</span></code> routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>inverse_cv1</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>defaults to False</em>) – If set to True, the CV1-axis will be inverted prior to bias evaluation. WARNING: possible rest value parameters of the potential (such as the rest value q01 of the Parabola2D potential) will not be multiplied with -1!</p></li>
<li><p><strong>inverse_cv2</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>defaults to False</em>) – If set to True, the CV2-axis will be inverted prior to bias evaluation. WARNING: possible rest value parameters of the potential (such as the rest value q02 of the Parabola2D potential) will not be multiplied with -1!</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential2D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">10.,</span> <span class="pre">20.,</span> <span class="pre">30.,</span> <span class="pre">40.,</span> <span class="pre">50.,</span> <span class="pre">60.,</span> <span class="pre">70.,</span> <span class="pre">80.,</span> <span class="pre">90.,</span> <span class="pre">100.])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential2D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential2D.plot" title="Permalink to this definition"></a></dt>
<dd><p>Routine to make a plot of the bias potential as function of the CV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1s</strong> (<em>np.ndarray</em>) – array representing the cv1 grid on which the bias is evaluated</p></li>
<li><p><strong>cv2s</strong> (<em>np.ndarray</em>) – array representing the cv2 grid on which the bias is evaluated</p></li>
<li><p><strong>fn</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – file name to write the plot to. If None, the plot is not written to a file.</p></li>
<li><p><strong>temp</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – If None, the bias potential itself is plotted. Else, the boltzmann factor exp(-V/kT) corresponding with the bias potential V is computed at the corresponding temperature given by temp.</p></li>
<li><p><strong>e_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – energy unit in which the bias potential will be plotted. This parameter is ignored if temp is not None</p></li>
<li><p><strong>cv1_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the CV1 will be plotted</p></li>
<li><p><strong>cv2_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the CV2 will be plotted</p></li>
<li><p><strong>cv1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV1'</em>) – Label of the CV1 to be used in the x-label of the plot</p></li>
<li><p><strong>cv2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV2'</em>) – Label of the CV2 to be used in the x-label of the plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential2D.print">
<span class="sig-name descname"><span class="pre">print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">pars_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential2D.print"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential2D.print" title="Permalink to this definition"></a></dt>
<dd><p>Routine to return a formatted string defining the current bias for logging purposes. The keywords arguments in <code class="docutils literal notranslate"><span class="pre">pars_units</span></code> are defined in the <code class="docutils literal notranslate"><span class="pre">print_pars</span></code> routine defined in the child classes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.BiasPotential2D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">pars_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#BiasPotential2D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.BiasPotential2D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine to format a string containing the parameters of the bias for printing/logging purposes. This routine needs to be implemented in each child class.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.MultipleBiasses1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">MultipleBiasses1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">biasses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#MultipleBiasses1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.MultipleBiasses1D" title="Permalink to this definition"></a></dt>
<dd><p>A class to add multiple bias potentials together, possibly weighted by given coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>biasses</strong> (list of instances of child classes of <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a>) – list of bias potentials</p></li>
<li><p><strong>coeffs</strong> (<em>list/np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – array of weigth coefficients. If None, coeffs is set to an array of ones (i.e. no weighting is applied).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if biasses argument is not a list</p></li>
<li><p><strong>AssertionError</strong> – if a bias in the biasses list is not an instance of <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a></p></li>
<li><p><strong>AssertionError</strong> – if coeffs is not a np.ndarray</p></li>
<li><p><strong>AssertionError</strong> – if biasses and coeffs are not of equal length</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.MultipleBiasses1D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">par_units</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#MultipleBiasses1D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.MultipleBiasses1D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine used by the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine defined in the parent <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a> to print the parameters of the bias potential in a formatted way. The keyword arguments defined below, can be specified upon calling the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine  and will be parsed to the individual <code class="docutils literal notranslate"><span class="pre">print</span></code> routines of each bias. Hence, you can append the unit definitions of each bias in the list as keyword arguments of the current routine.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Parabola1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">Parabola1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Parabola1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Parabola1D" title="Permalink to this definition"></a></dt>
<dd><p>A 1-dimensional parabolic bias potential</p>
<div class="math">
<p><img src="_images/math/2eca8cce7986ebdc087f9bfbe4c02d3bf4b56e6f.png" alt="V(q) = \frac{\kappa}{2}\left(s*q-q_0\right)^2"/></p>
</div><p>The potential can be computed for a given CV value using its <code class="docutils literal notranslate"><span class="pre">__call__</span></code> routine, the bias definition can be printed in a formated way using its <code class="docutils literal notranslate"><span class="pre">print</span></code> routine and a plot can be made using its <code class="docutils literal notranslate"><span class="pre">plot</span></code> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>q0</strong> (<em>float</em>) – the value of the parabola equilibruim (i.e. its minimum)</p></li>
<li><p><strong>kappa</strong> (<em>float</em>) – the force constant of the parabola</p></li>
<li><p><strong>inverse_cv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>defaults to False</em>) – If set to True, the CV-axis will be inverted prior to bias evaluation (sets <img class="math" src="_images/math/56cde6194cd3bd6153fd37a0c1199aff0fed06c5.png" alt="s=-1"/> in the above formula for the bias potential). WARNING: the rest value parameter q0 of the potential will not be multiplied with -1!</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Parabola1D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q0_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Parabola1D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Parabola1D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine used by the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine defined in the parent <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a> to print the parameters of the bias potential in a formatted way. The keyword arguments defined below, can be specified upon calling the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kappa_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – Unit of the parabola force constant kappa</p></li>
<li><p><strong>q0_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – Unit of the parabola equilibrium CV value q0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Parabola2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">Parabola2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Parabola2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Parabola2D" title="Permalink to this definition"></a></dt>
<dd><p>A 2-dimensional parabolic bias potential.</p>
<div class="math">
<p><img src="_images/math/691bbedda447360618c0e4f9732d51b4d8d69cc4.png" alt="V(q_1,q_2) = \frac{\kappa_1}{2}\left(s_1*q_1-q_{1,0}\right)^2 + \frac{\kappa_2}{2}\left(s_2*q_2-q_{2,0}\right)^2"/></p>
</div><p>The potential can be computed for a given CV value using its <code class="docutils literal notranslate"><span class="pre">__call__</span></code> routine, the bias definition can be printed in a formated way using its <code class="docutils literal notranslate"><span class="pre">print</span></code> routine and a plot can be made using its <code class="docutils literal notranslate"><span class="pre">plot</span></code> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>q01</strong> (<em>float</em>) – the value of the first collective variable corresponding to the parabola minimum</p></li>
<li><p><strong>q02</strong> (<em>float</em>) – the value of the second collective variable corresponding to the parabola minimum</p></li>
<li><p><strong>kappa1</strong> – the force constant of the parabola in the direction of the first collective variable</p></li>
<li><p><strong>kappa2</strong> – the force constant of the parabola in the direction of the second collective variable</p></li>
<li><p><strong>inverse_cv1</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>defaults to False</em>) – If set to True, the CV1-axis will be inverted prior to bias evaluation (sets <img class="math" src="_images/math/e5ea07c829a625091c62988d74d6977d9d9dd9cb.png" alt="s_1=-1"/> in the expression above). WARNING: the rest value parameter q01 will not be multiplied with -1!</p></li>
<li><p><strong>inverse_cv2</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>defaults to False</em>) – If set to True, the CV2-axis will be inverted prior to bias evaluation (sets <img class="math" src="_images/math/8477645c26b043b20c2eaa671e58bf4dd11dfbe2.png" alt="s_2=-1"/> in the expression above). WARNING: the rest value parameter q02 will not be multiplied with -1!</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Parabola2D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa1_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa2_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q01_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q02_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Parabola2D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Parabola2D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine used by the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine defined in the parent <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a> to print the parameters of the bias potential in a formatted way. The keyword arguments defined below, can be specified upon calling the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential2D.print" title="thermolib.thermodynamics.bias.BiasPotential2D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kappa1_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – Unit of the parabola force constant kappa along the first CV</p></li>
<li><p><strong>kappa2_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – Unit of the parabola force constant kappa along the second CV</p></li>
<li><p><strong>q01_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – Unit of the CV1 value corresponding to the parabola equilibrium (minimum)</p></li>
<li><p><strong>q02_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – Unit of the CV2 value corresponding to the parabola equilibrium (minimum)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.PlumedSplinePotential1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">PlumedSplinePotential1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#PlumedSplinePotential1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.PlumedSplinePotential1D" title="Permalink to this definition"></a></dt>
<dd><p>A bias potential read from a PLUMED file, which is spline-interpolated. The potential can be computed for a given CV value using its <code class="docutils literal notranslate"><span class="pre">__call__</span></code> routine, the bias definition can be printed in a formated way using its <code class="docutils literal notranslate"><span class="pre">print</span></code> routine and a plot can be made using its <code class="docutils literal notranslate"><span class="pre">plot</span></code> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>fn</strong> (<em>str</em>) – specifies the filename of an external potential written on a grid and acting on the collective variable, as used with the EXTERNAL keyword in PLUMED.</p></li>
<li><p><strong>inverse_cv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If set to True, the CV-axis will be inverted prior to bias evaluation.</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit used to express the external potential</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1.0</em>) – scaling factor for the bias potential (useful to invert free energy surfaces)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.PlumedSplinePotential1D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#PlumedSplinePotential1D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.PlumedSplinePotential1D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Not implemented, will just return empty string.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Polynomial1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.bias.</span></span><span class="sig-name descname"><span class="pre">Polynomial1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Polynomial1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Polynomial1D" title="Permalink to this definition"></a></dt>
<dd><p>Bias potential given by general polynomial of any degree:</p>
<div class="math">
<p><img src="_images/math/450ab0c52552e6473f5b210858a5322e4aed0b69.png" alt="V(q) = \sum_{n}a_n\left(s*q\right)^n"/></p>
</div><p>The potential can be computed for a given CV value using its <code class="docutils literal notranslate"><span class="pre">__call__</span></code> routine, the bias definition can be printed in a formated way using its <code class="docutils literal notranslate"><span class="pre">print</span></code> routine and a plot can be made using its <code class="docutils literal notranslate"><span class="pre">plot</span></code> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – name for the bias which will also be given in the title of plots</p></li>
<li><p><strong>coeffs</strong> (<em>list/np.ndarray</em>) – list of expansion coefficients of the polynomial in increasing order starting with the coefficient of power 0. The degree of the polynomial is given by len(coeffs)-1</p></li>
<li><p><strong>inverse_cv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If True, the CV-axis will be inverted prior to bias evaluation (sets <img class="math" src="_images/math/56cde6194cd3bd6153fd37a0c1199aff0fed06c5.png" alt="s=-1"/> in the above formula for the bias potential).</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the bias is given</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.bias.Polynomial1D.print_pars">
<span class="sig-name descname"><span class="pre">print_pars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/bias.html#Polynomial1D.print_pars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.bias.Polynomial1D.print_pars" title="Permalink to this definition"></a></dt>
<dd><p>Routine used by the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine defined in the parent <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D" title="thermolib.thermodynamics.bias.BiasPotential1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">BiasPotential1D</span></code></a> to print the parameters of the bias potential in a formatted way. The keyword arguments defined below, can be specified upon calling the <a class="reference internal" href="#thermolib.thermodynamics.bias.BiasPotential1D.print" title="thermolib.thermodynamics.bias.BiasPotential1D.print"><code class="xref py py-meth docutils literal notranslate"><span class="pre">print</span></code></a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e_unit</strong> – energy unit to be used in defining the units of the coefficients</p></li>
<li><p><strong>q0_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – cv unit to be used in defining the units of the coefficients</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.cv">
<span id="collective-variables-thermolib-thermodynamics-cv"></span><h2>Collective variables – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.cv</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.cv" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Average">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">Average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Average" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the average of two other collective variables as</p>
<div class="math">
<p><img src="_images/math/cd0f84b37c7ee1e6f4f7fb32b0cafd95405af992.png" alt="CV &amp;= \frac{CV_1 + CV_2}{2}"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – first collective variable in the average</p></li>
<li><p><strong>cv2</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – second collective variable in the average</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Average.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Average.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Average.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the average (and optionally gradient) of the two CVs for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CenterOfMass">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">CenterOfMass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CenterOfMass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CenterOfMass" title="Permalink to this definition"></a></dt>
<dd><p>Class the implement the computation of the center of mass (COM) of a set of atoms defined by their atomic indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em><em> of </em><em>integers</em>) – indices of the atoms of which the COM needs to be computed</p></li>
<li><p><strong>masses</strong> (<em>np.ndarray</em>) – masses of all atoms in the molecular system. The relevant atomic masses will then be extracted using the indices parameter.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CenterOfMass.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CenterOfMass.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CenterOfMass.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute CV value (and optionally its gradient) for given coordinates of the molecular system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CenterOfPosition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">CenterOfPosition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CenterOfPosition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CenterOfPosition" title="Permalink to this definition"></a></dt>
<dd><p>Class the implement the computation of the center of positions of a set of atoms defined by their atomic indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em><em> of </em><em>integers</em>) – indices of the atoms of which the COP needs to be computed</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CenterOfPosition.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CenterOfPosition.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CenterOfPosition.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute CV value (and optionally its gradient) for given coordinates of the molecular system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CoordinationNumber">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">CoordinationNumber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.779452267842504</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CoordinationNumber"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CoordinationNumber" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the coordination number of a certain atom pair or a set of atom pairs. If <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/> atom pairs are defined, the coordination number should be a number between <img class="math" src="_images/math/31fdf41b39df23c95e52c5aef07f59d9adf82f3c.png" alt="0"/> and <img class="math" src="_images/math/5a939c5280da7202ca4531f175a7780ad5e1f80a.png" alt="n"/>.</p>
<div class="math">
<p><img src="_images/math/a47f12bd32445a34372d1333cbb8e2c0152a9d20.png" alt="CN &amp;= \sum_{ij \in pairs} \frac{1-\left(\frac{r_{ij}}{r_0}\right)^{nn}}{1-\left(\frac{r_{ij}}{r_0}\right)^{nd}}"/></p>
</div><p>in which</p>
<ul class="simple">
<li><p><img class="math" src="_images/math/774df2c68904c92b7c0db636d12ca2ca6ee21263.png" alt="r_{ij}"/> is the distance between atom i an atom j as defined in pair (i,j) present in pairs</p></li>
<li><p><img class="math" src="_images/math/02c849aad7960bc828467cc5933f8fe020201c4b.png" alt="r_0"/> is a reference distance for the bond between two atoms set to 2 angstrom by default but can be defined in the keyword arguments by the user</p></li>
<li><p><img class="math" src="_images/math/d0bd83c2eb74e3ce86d525133586c66766c90869.png" alt="nn"/> and <img class="math" src="_images/math/b77be497b074cc325c72c2a74d9671860c2c092d.png" alt="nd"/> are integers that are set to 6 and 12 respectively by default but can also be defined in the keyword arguments by the user</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>list tuples</em>) – pairs of atoms between which the coordination number needs to be computed</p></li>
<li><p><strong>r0</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=2*angstrom</em>) – reference index for a chemical bond used in the definition of the coordination number</p></li>
<li><p><strong>nn</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=6</em>) – power coefficient used in the nominator in the definition of the coordination number</p></li>
<li><p><strong>nd</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=12</em>) – power coefficient used in the denominator in the definition of the coordination number</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.CoordinationNumber.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#CoordinationNumber.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.CoordinationNumber.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the coordination number (and optionally gradient) between the atom pairs for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Difference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">Difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Difference" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the difference between two other collective variables:</p>
<div class="math">
<p><img src="_images/math/c4229d908885e34873fc9a2a5130e7edfa6b5aab.png" alt="CV &amp;= CV_2 - CV_1"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – first collective variable in the difference</p></li>
<li><p><strong>cv2</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – second collective variable in the difference</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Difference.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Difference.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Difference.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the difference (and optionally gradient) between the two CVs for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.DistOrthProjOrig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">DistOrthProjOrig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#DistOrthProjOrig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.DistOrthProjOrig" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable that represents the distance between (1) the orthogonal projection of a position (defined by a CV denoted as pos) on an axis (defined by a CV denoted as axis) through an origin (defined by a CV denoted as orig) and (2) the origin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (child instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code> with type=’vector’) – the CV corresponding to the position that needs to be projected on the axis</p></li>
<li><p><strong>axis</strong> (<a class="reference internal" href="#thermolib.thermodynamics.cv.NormalizedAxis" title="thermolib.thermodynamics.cv.NormalizedAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizedAxis</span></code></a>) – the CV corresponding to the axis on which the position needs to be projected</p></li>
<li><p><strong>orig</strong> (child instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code> with type=’vector’) – the CV corresponding to the origin through which the axis needs to go and with which the difference of the projected pos will be computed</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if pos is not a (child) instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code> with pos.type=’vector’</p></li>
<li><p><strong>AssertionError</strong> – if axis is not an instance of <a class="reference internal" href="#thermolib.thermodynamics.cv.NormalizedAxis" title="thermolib.thermodynamics.cv.NormalizedAxis"><code class="xref py py-class docutils literal notranslate"><span class="pre">NormalizedAxis</span></code></a></p></li>
<li><p><strong>AssertionError</strong> – if orig is not a (child) instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code> with orig.type=’vector’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Distance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">Distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Distance" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the distance between two atoms given by index1 and index2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index1</strong> – index of the first atom</p></li>
<li><p><strong>index2</strong> – index of the second atom</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Distance.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Distance.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Distance.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the distance (and optionally gradient) between the two atoms for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.DistanceCOP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">DistanceCOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#DistanceCOP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.DistanceCOP" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the distance between a first atom (index1) and the center of position (i.e. the geometric center) of two other atoms (index2a and index2b).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index1</strong> – index of the first atom</p></li>
<li><p><strong>index2a</strong> – index of the other atom a</p></li>
<li><p><strong>index2b</strong> – index of the other atom b</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.DistanceCOP.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#DistanceCOP.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.DistanceCOP.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the COP distance (and optionally gradient) between the atoms for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.DotProduct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">DotProduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#DotProduct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.DotProduct" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable that is the dot product of two given vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> (<em>instance</em><em> of </em><em>child class</em><em> of </em><em>CollectiveVariable with type='vector'</em>) – first of two vectors defining the plane for which the normal needs to be computed</p></li>
<li><p><strong>vec2</strong> (<em>instance</em><em> of </em><em>child class</em><em> of </em><em>CollectiveVariable with type='vector'</em>) – second of two vectors defining the plane for which the normal needs to be computed</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if vec1 is not instance of (child of) CollectiveVariable</p></li>
<li><p><strong>AssertionError</strong> – if vec1.type is not ‘vector’</p></li>
<li><p><strong>AssertionError</strong> – if vec2 is not instance of (child of) CollectiveVariable</p></li>
<li><p><strong>AssertionError</strong> – if vec2.type is not ‘vector’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.DotProduct.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#DotProduct.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.DotProduct.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the dot product (and optionally gradient) of the two vectors for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.LinearCombination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">LinearCombination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cvs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#LinearCombination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.LinearCombination" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable that is the linear combination of other collective variables</p>
<div class="math">
<p><img src="_images/math/a7c53233c353020905df2b748f84565410a3394b.png" alt="CV &amp;= \sum_{i=1}^N c_i\cdot CV_i"/></p>
</div><p>in which cvs is the list of involved collective variables and coeffs is list of equal length with the corresponing coefficients</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cvs</strong> (list of instances of child classes of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – list of CVs in the linear combination</p></li>
<li><p><strong>coeffs</strong> (<em>list</em><em> or </em><em>array</em>) – coefficients corresponding to the weight of each CV in the linear combination</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.LinearCombination.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#LinearCombination.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.LinearCombination.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the linear combination (and optionally gradient) of the CVs for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Minimum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">Minimum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cv1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Minimum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Minimum" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable representing the minimum of two other collective variables:</p>
<div class="math">
<p><img src="_images/math/b3ca53270165e024e3c9a764b5c11ec9815ad1b3.png" alt="CV &amp;= \min\left(CV_1,CV_2\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv1</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – first collective variable in the minimum</p></li>
<li><p><strong>cv2</strong> (any child class of <code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – second collective variable in the minimum</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.Minimum.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#Minimum.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.Minimum.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the minimum (and optionally gradient) of the two CVs for the given atomic coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.NormalToPlane">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">NormalToPlane</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#NormalToPlane"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.NormalToPlane" title="Permalink to this definition"></a></dt>
<dd><p>Class the implement the computation of the normal to a plane defined by a set of atoms that are assumed to be orderd at the cornerpoints of a regular n-fold polygon</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em><em> of </em><em>integers</em>) – indices of the atoms in the plane for which the normal needs to be computed</p></li>
<li><p><strong>name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.NormalToPlane.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#NormalToPlane.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.NormalToPlane.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the normal to the ring plane (and optionally the gradient) for the given atomic coordinates. Calculations assumes that the n atoms that constitute the ring are orderd at the cornerpoints of a regular n-fold polygon</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.NormalizedAxis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">NormalizedAxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#NormalizedAxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.NormalizedAxis" title="Permalink to this definition"></a></dt>
<dd><p>Class the implement the computation of the normalized axis between two points, i.e. as the normalized difference of two input vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vec1</strong> (<em>instance</em><em> of </em><em>child class</em><em> of </em><em>CollectiveVariable with type='vector'</em>) – first of two vectors defining the plane for which the normal needs to be computed</p></li>
<li><p><strong>vec2</strong> (<em>instance</em><em> of </em><em>child class</em><em> of </em><em>CollectiveVariable with type='vector'</em>) – second of two vectors defining the plane for which the normal needs to be computed</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if vec1 is not instance of (child of) CollectiveVariable</p></li>
<li><p><strong>AssertionError</strong> – if vec1.type is not ‘vector’</p></li>
<li><p><strong>AssertionError</strong> – if vec2 is not instance of (child of) CollectiveVariable</p></li>
<li><p><strong>AssertionError</strong> – if vec2.type is not ‘vector’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.NormalizedAxis.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#NormalizedAxis.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.NormalizedAxis.compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute CV value (and optionally its gradient) for given coordinates of the molecular system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>[</em><em>Natoms</em><em>,</em><em>3</em><em>]</em><em>)</em>) – atomic coordinates of each atom in the molecular system</p></li>
<li><p><strong>deriv</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – if True, also compute and return the gradient of the CV towards all atomic coordinates</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CV value and potentially the gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray(3) or float,np.ndarray([3,Natoms,3])</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.cv.OrthogonalDistanceToPore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.cv.</span></span><span class="sig-name descname"><span class="pre">OrthogonalDistanceToPore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ring_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guest_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cell_pars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/cv.html#OrthogonalDistanceToPore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.cv.OrthogonalDistanceToPore" title="Permalink to this definition"></a></dt>
<dd><p>Class to implement a collective variable that represents the orthogonal distance between the center of mass of a guest molecule defined by its atom indices (guest_indices) on the one hand, and a pore ring defined by the atom indices of its constituting atoms (ring_indices) on the other hand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ring_indices</strong> (<em>list</em><em> of </em><em>integers</em>) – atomic indices of the ring</p></li>
<li><p><strong>guest_indices</strong> (<em>list</em><em> of </em><em>integers</em>) – atomic indices of the guest</p></li>
<li><p><strong>masses</strong> (<em>np.ndarray</em>) – masses of all atoms in the molecular system. The relevant atomic masses of the guest atoms will then be extracted using the guest_indices parameter.</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Name of CV for printing/logging purposes. If None, the default implemented in the <code class="docutils literal notranslate"><span class="pre">_default_name</span></code> routine will be used.</p></li>
<li><p><strong>unit_cell_pars</strong> (<em>np.ndarray</em><em> | </em><em>None</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Unit cell parameters that may be required to compute the CV value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.state">
<span id="state-thermolib-thermodynamics-state"></span><h2>State – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.state</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.state" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.state.Integrate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.state.</span></span><span class="sig-name descname"><span class="pre">Integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_unit='kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/state.html#Integrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.state.Integrate" title="Permalink to this definition"></a></dt>
<dd><p>Definie macrostate as the boltzmann weighted integral over a range of microstates (i.e. range of points on the fep). The macrostate properties (mean cv, cvstd and macrostate free energy) are defined as follows</p>
<div class="math">
<p><img src="_images/math/c22cbb2c048aeeb3be220191fab5bc7f54aabda7.png" alt="\left\langle cv \right\rangle   &amp;= \frac{\int q e^{-\beta F(q)} dq}{\int e^{-\beta F(q)} dq} \\
\sigma^2                           &amp;= \frac{\int \left(q-\left\langle cv \right\rangle\right)^2 e^{-\beta F(q)} dq}{\int e^{-\beta F(q)} dq} \\
f                                   &amp;= -k_B T \ln\left[\int e^{-\beta F(q)} dq\right]"/></p>
</div><p>Herein, all integrals are done over a given cv range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – a name for the state to be used in printing/loging</p></li>
<li><p><strong>cv_range</strong> (list of either floats or <code class="xref py py-class docutils literal notranslate"><span class="pre">MicroStates</span></code>) – the range for the cv defining the macrostate in the integrals above</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – the beta (i.e. 1/kT) value used in the boltzmann weighting</p></li>
<li><p><strong>cv_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – a unit for the cv properties in the state used in printing/loging</p></li>
<li><p><strong>f_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – a unit for the (free) energy properties in the state used in printing/loging</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.state.Maximum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.state.</span></span><span class="sig-name descname"><span class="pre">Maximum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_range=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_unit='au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_unit='kjmol'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/state.html#Maximum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.state.Maximum" title="Permalink to this definition"></a></dt>
<dd><p>Microstate class that identifies the maximum in a certain range defined by either cv values, indexes or other microstates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – a name for the state to be used in printing/loging</p></li>
<li><p><strong>cv_range</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-np.inf</em><em>, </em><em>np.inf</em><em>]</em>) – the microstate cv value will be looked for only in this range</p></li>
<li><p><strong>cv_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – a unit for the cv properties in the state used in printing/loging</p></li>
<li><p><strong>f_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – a unit for the (free) energy properties in the state used in printing/loging</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.state.Minimum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.state.</span></span><span class="sig-name descname"><span class="pre">Minimum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name,</span> <span class="pre">cv_range=[-inf,</span> <span class="pre">inf],</span> <span class="pre">cv_unit='au',</span> <span class="pre">f_unit='kjmol',</span> <span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/state.html#Minimum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.state.Minimum" title="Permalink to this definition"></a></dt>
<dd><p>Microstate class that identifies the minimum in a certain range defined by either cv values, indexes or other microstates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – a name for the state to be used in printing/loging</p></li>
<li><p><strong>cv_range</strong> (<em>list</em><em>, </em><em>optional</em><em>, </em><em>default=</em><em>[</em><em>-np.inf</em><em>, </em><em>np.inf</em><em>]</em>) – the microstate cv value will be looked for only in this range</p></li>
<li><p><strong>cv_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – a unit for the cv properties in the state used in printing/loging</p></li>
<li><p><strong>f_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='kjmol'</em>) – a unit for the (free) energy properties in the state used in printing/loging</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator()) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-thermolib.thermodynamics.condprob">
<span id="conditional-probability-thermolib-thermodynamics-condprob"></span><h2>Conditional probability – <code class="docutils literal notranslate"><span class="pre">thermolib.thermodynamics.condprob</span></code><a class="headerlink" href="#module-thermolib.thermodynamics.condprob" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.condprob.</span></span><span class="sig-name descname"><span class="pre">ConditionalProbability1D1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Q'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D" title="Permalink to this definition"></a></dt>
<dd><p>Class to compute and store conditional probabilities of the form <img class="math" src="_images/math/c69f9ebc7d7f6fd669d450ece6abff75357de4c1.png" alt="p(q|cv)"/> which allow to convert a free energy profile in terms of the collective variable <img class="math" src="_images/math/b492529650095ff31555e14ae18a3cb64d8f770c.png" alt="cv"/> to a free energy profile in terms of the collective variable <img class="math" src="_images/math/a5fa84b363f309ebc8fe7db38304541732c7de9a.png" alt="q"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_bins</strong> (<em>see np.histogram and np.histogram2d</em><em>, </em><em>optional</em>) – np.histogram argument for defining the bins of Q samples</p></li>
<li><p><strong>cv_bins</strong> (<em>see np.histogram and np.histogram2d</em><em>, </em><em>optional</em>) – np.histogram argument for defining the bins of CV samples</p></li>
<li><p><strong>q_label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for Q used for plotting/logging, defaults to ‘Q’</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for Q used for plotting/logging, defaults to ‘CV’</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – make all class routines more verbose in their logging</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.average">
<span class="sig-name descname"><span class="pre">average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.average" title="Permalink to this definition"></a></dt>
<dd><p>Compute the average of Q as function of CV</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=MultiGaussianDistribution)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken, or the desired distribution of the targeted error). See documentation on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code> class for more info.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Q profile as function of CV</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#thermolib.thermodynamics.fep.BaseProfile" title="thermolib.thermodynamics.fep.BaseProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseProfile</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.deproject">
<span class="sig-name descname"><span class="pre">deproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.FreeEnergySurface2D'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.deproject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.deproject" title="Permalink to this definition"></a></dt>
<dd><p>Deproject the provided 1D FEP F(q) to a 2D FES F(q,v) using the current conditional probability according to the formula</p>
<div class="math">
<p><img src="_images/math/9badba10ad93d3a6dcd56e8b62b91fc95bcafafb.png" alt="F(q_1,q_2) &amp;= F(q_2)-kT \ln\left(p(q_1|q_2)\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fep</strong> (<em>(</em><em>child of</em><em>) </em><a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><em>BaseFreeEnergyProfile</em></a>) – the free energy profile F(q_2) which will be transformed</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the unit of the deprojected free energy profile to be used in plotting and printing of energies. If None, the f_output_unit of the original 1D free energy profile will be used.</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the label of the deprojected free energy profile to be used in plotting and printing. If None, the f_label of the original 1D free energy profile will be used.</p></li>
<li><p><strong>f_output_class</strong> (<em>class</em><em>, </em><em>optional</em>) – the class of the output free energy profile, defaults to FreeEnergySurface2D</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=MultiGaussianDistribution)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken, or the desired distribution of the targeted error). See documentation on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code> class for more info.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if the conditional probability has not been finished yetµ</p></li>
<li><p><strong>AssertionError</strong> – if the fep argument is not a <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a></p></li>
<li><p><strong>AssertionError</strong> – if the cv grids in self.cvs[0] and fep.cvs are not consistent</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.finish_error">
<span class="sig-name descname"><span class="pre">finish_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">error_estimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_p_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.finish_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.finish_error" title="Permalink to this definition"></a></dt>
<dd><p>Estimate error bars on the conditional probability. This routine will be called by the <code class="docutils literal notranslate"><span class="pre">finish</span></code> routine if the error_estimate keyword parsed there is not None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>error_estimate</strong> – <p>indicate if and how to perform error analysis. One of following options is available:</p>
<blockquote>
<div><ul>
<li><p><strong>mle_p</strong> - Estimating the error directly for the probability of each bin in the histogram. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_p_cov</strong> - Estimate the full covariance matrix for the probability of all bins in the histogram. In other words, appart from the error on the probability/free energy of a bin itself, we now also account for the covariance between the probabilty/free energy of the bins. This method does not explicitly impose the positivity of the probability.</p></li>
<li><p><strong>mle_f</strong> - Estimating the error for minus the logarithm of the probability, which is proportional to the free energy (hence f in mle_f). As the probability is expressed as <img class="math" src="_images/math/fd30f69643ea04ca7c6c456203a0cfd15b0cd92f.png" alt="\propto e^{-f}"/>, its positivity is explicitly accounted for.</p></li>
<li><p><strong>mle_f_cov</strong> - Estimate the full covariance matrix for minus the logarithm of the probability of all bins in the histogram. In other words, appart from the error on the probabilty/free energy of a bin itself (including explicit positivity constraint), we now also account for the covariance between the probability/free energy of the bins.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">type error_estimate<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</p></li>
<li><p><strong>error_p_threshold</strong> – When <code class="docutils literal notranslate"><span class="pre">error_p_threshold</span></code> is set to x, bins in the histogram for which the probability resulting from the trajectory is smaller than x will be disabled for error estimation (i.e. its error will be set to np.nan).
:type error_p_threshold: float, optional, default=0.0</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – if an invalid definition for error_estimate is provided</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.process_trajectory_cvs">
<span class="sig-name descname"><span class="pre">process_trajectory_cvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.process_trajectory_cvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.process_trajectory_cvs" title="Permalink to this definition"></a></dt>
<dd><p>Included for backwards compatibility, this routine will call the more general process_trajectory routine of the parent class.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is no longer possible to finish automatically after processing a trajectory. Finishing must alwasy be done manually by calling the finish routine!</p>
</div>
<p>Extract Q and CV samples from the given COLVAR trajectories. These samples will later be utilized by the finish routine to construct the conditional probability. The trajectory files may also contain data from simulations that are biased in CV space (not Q space!!). Each CV trajectory file contains rows of the form</p>
<blockquote>
<div><p>time q cv</p>
</div></blockquote>
<p>If the trajectory file contains this data in a different order, it can be accounted for using the col_xx keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fns</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em>) – file name (or list of file names) of colvar files with the above formatting containing the trajectory data.</p></li>
<li><p><strong>col_q</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – column index of the collective variable Q in the given input file</p></li>
<li><p><strong>col_cv</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=2</em>) – column index of the collective variable CV in the given input file</p></li>
<li><p><strong>unit_q</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the q values are stored in the file</p></li>
<li><p><strong>unit_cv</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the cv values are stored in the file</p></li>
<li><p><strong>sub</strong> (<em>slice</em><em>, </em><em>optional</em><em>, </em><em>default=slice</em><em>(</em><em>None</em><em>, </em><em>None</em><em>, </em><em>None</em><em>)</em>) – python slice instance to subsample the trajectory</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – set to True to increase verbosity of the ColVarReader when reading samples from the trajectory files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.process_trajectory_xyz">
<span class="sig-name descname"><span class="pre">process_trajectory_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.process_trajectory_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.process_trajectory_xyz" title="Permalink to this definition"></a></dt>
<dd><p>Included for backwards compatibility , this routine will call the more general process_trajectory routine of the parent class.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is no longer possible to finish automatically after processing a trajectory. Finishing must alwasy be done manually by calling the finish routine!</p>
</div>
<p>Extract Q and CV samples from the given XYZ trajectories. These samples will later be utilized by the finish routine to construct the conditional probability. The trajectory files may also contain data from simulations that are biased in CV space (not Q space!!).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fns</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em>) – file name (or list of file names) which contain trajectories that are used to compute the conditional probability.</p></li>
<li><p><strong>Q</strong> (<em>CollectiveVariable</em>) – collective variable used to compute the CV value from a trajectory file</p></li>
<li><p><strong>CV</strong> (<em>CollectiveVariable</em>) – collective variable used to compute the CV value from a trajectory file</p></li>
<li><p><strong>sub</strong> (<em>slice</em><em>, </em><em>optional</em><em>, </em><em>default=slice</em><em>(</em><em>None</em><em>, </em><em>None</em><em>, </em><em>None</em><em>)</em>) – python slice instance to subsample the trajectory</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – set to True to increase verbosity of the CVComputer to compute CV values from the trajectories</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D1D.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.BaseFreeEnergyProfile'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D1D.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D1D.transform" title="Permalink to this definition"></a></dt>
<dd><p>Transform the provided 1D FES to a different 1D FES using the current conditional probability according to the formula.</p>
<div class="math">
<p><img src="_images/math/f9db1771e76ca757c0afea924ed382be915adcf4.png" alt="F(q) &amp;= -kT \ln\left(\int p(q|v)\cdot e^{-\beta F(v)} dv\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fep</strong> (<a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a>) – the input free energy profile F(cv) which will be transformed towards F(q)</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the unit of the transformed free energy profile to be used in plotting and printing of energies. If None, the f_output_unit of the original free energy profile will be used.</p></li>
<li><p><strong>f_label</strong> – the label of the transformed free energy profile to be used in plotting and printing. If None, the f_label of the original free energy profile will be used.</p></li>
<li><p><strong>f_output_class</strong> (class, optional, default= <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a>) – the class of the output free energy profile. If you want to use specific features of the <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile</span></code></a> class (such as e.g. automatic detection of reactant, transition state and product state micro/macrostates) in the transformed fep, define this argument as <a class="reference internal" href="#thermolib.thermodynamics.fep.SimpleFreeEnergyProfile" title="thermolib.thermodynamics.fep.SimpleFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFreeEnergyProfile</span></code></a>.</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=MultiGaussianDistribution)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken, or the desired distribution of the targeted error). See documentation on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code> class for more info.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if the conditional probability has not been finished yetµ</p></li>
<li><p><strong>AssertionError</strong> – if the fep argument is not a <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a></p></li>
<li><p><strong>AssertionError</strong> – if the cv grids in self.cvs[0] and fep.cvs are not consistent</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D2D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermolib.thermodynamics.condprob.</span></span><span class="sig-name descname"><span class="pre">ConditionalProbability1D2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q1_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Q1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Q2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CV'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q1_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D2D" title="Permalink to this definition"></a></dt>
<dd><p>Class to store and compute conditional probabilities of the form <img class="math" src="_images/math/18c8d92b21e7e66ead4dec7ba5e2d747d9745c5c.png" alt="p(q_1,q_2|cv)"/> which can be used to transform a 1D free energy profile in terms of the collective variable <img class="math" src="_images/math/b492529650095ff31555e14ae18a3cb64d8f770c.png" alt="cv"/> towards a 2D free energy surface in terms of the collective variables <img class="math" src="_images/math/690d77563c4babc4ea9f0cf597771cdf8b353a0a.png" alt="q_1"/> and <img class="math" src="_images/math/eeffde4b510c8320fd2429e9086cc15f36e87f19.png" alt="q_2"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q1_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='Q1'</em>) – label for Q1 used for plotting/logging</p></li>
<li><p><strong>q2_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='Q2'</em>) – label for Q2 used for plotting/logging</p></li>
<li><p><strong>cv_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='CV'</em>) – label for Q used for plotting/logging</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – set to True to increase verbosity of TrajectoryReaders used to compute the various CV samples along an XYZ trajectory</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D2D.deproject">
<span class="sig-name descname"><span class="pre">deproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_unit=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_output_class=&lt;class</span> <span class="pre">'thermolib.thermodynamics.fep.FreeEnergySurface2D'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagator=&lt;thermolib.error.Propagator</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D2D.deproject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D2D.deproject" title="Permalink to this definition"></a></dt>
<dd><p>Transform the provided 1D FEP to a 2D FES using the current conditional probability according to the formula</p>
<div class="math">
<p><img src="_images/math/2633f4fd119d7c1f92ff8bfe91c919027ea846fa.png" alt="F(q_1,q_2) &amp;= -kT\cdot\ln\left(\int p(q_1,q_2|v)\cdot e^{-\beta F(v)}dv\right)"/></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fep</strong> (<a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><em>BaseFreeEnergyProfile</em></a><em> or </em><em>child classes</em>) – the input free energy profile F(cv) which will be transformed towards F(q)</p></li>
<li><p><strong>f_output_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the unit of the deprojected free energy profile to be used in plotting and printing of energies. If None, the f_output_unit of the original 1D free energy profile will be used.</p></li>
<li><p><strong>f_label</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – the label of the deprojected free energy profile to be used in plotting and printing. If None, the f_label of the original 1D free energy profile will be used.</p></li>
<li><p><strong>f_output_class</strong> (<em>class</em><em>, </em><em>optional</em>) – the class of the output free energy profile, defaults to FreeEnergySurface2D</p></li>
<li><p><strong>propagator</strong> (instance of <a class="reference internal" href="rg_error.html#thermolib.error.Propagator" title="thermolib.error.Propagator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code></a>, optional, default=Propagator(target_distribution=MultiGaussianDistribution)) – a Propagator used for error propagation. Can be usefull if one wants to adjust the error propagation settings (such as the number of random samples taken, or the desired distribution of the targeted error). See documentation on the <code class="xref py py-class docutils literal notranslate"><span class="pre">Propagator</span></code> class for more info.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – if the conditional probability has not been finished yetµ</p></li>
<li><p><strong>AssertionError</strong> – if the fep argument is not a <a class="reference internal" href="#thermolib.thermodynamics.fep.BaseFreeEnergyProfile" title="thermolib.thermodynamics.fep.BaseFreeEnergyProfile"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseFreeEnergyProfile</span></code></a></p></li>
<li><p><strong>AssertionError</strong> – if the cv grids in self.cvs[0] and fep.cvs are not consistent</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D2D.process_trajectory_cvs">
<span class="sig-name descname"><span class="pre">process_trajectory_cvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_q1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_q2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_q1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_q2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'au'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D2D.process_trajectory_cvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D2D.process_trajectory_cvs" title="Permalink to this definition"></a></dt>
<dd><p>Included for backwards compatibility, this routine will call the more general process_trajectory routine of the parent class.</p>
<p>Extract Q and CV samples from the given COLVAR trajectories. These samples will later be utilized by the finish routine to construct the conditional probability. The trajectory files may also contain data from simulations that are biased in CV space (not Q space!!). Each CV trajectory file contains rows of the form</p>
<blockquote>
<div><p>time q1 q2 cv</p>
</div></blockquote>
<p>If the trajectory file contains this data in a different order, it can be accounted for using the col_xx keyword arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fns</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em>) – file name (or list of file names) of colvar files with the above formatting containing the trajectory data.</p></li>
<li><p><strong>col_q1</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – column index of the collective variable Q1 in the given input file</p></li>
<li><p><strong>col_q2</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>defaults=2</em>) – column index of the collective variable Q2 in the given input file</p></li>
<li><p><strong>col_cv</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=3</em>) – column index of the collective variable CV in the given input file</p></li>
<li><p><strong>unit_q1</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the q1 values are stored in the file</p></li>
<li><p><strong>unit_q2</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the q2 values are stored in the file</p></li>
<li><p><strong>unit_cv</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='au'</em>) – unit in which the cv values are stored in the file</p></li>
<li><p><strong>sub</strong> (<em>slice</em><em>, </em><em>optional</em><em>, </em><em>default=slice</em><em>(</em><em>None</em><em>, </em><em>None</em><em>, </em><em>None</em><em>)</em>) – python slice instance to subsample the trajectory</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermolib.thermodynamics.condprob.ConditionalProbability1D2D.process_trajectory_xyz">
<span class="sig-name descname"><span class="pre">process_trajectory_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">slice(None,</span> <span class="pre">None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermolib/thermodynamics/condprob.html#ConditionalProbability1D2D.process_trajectory_xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermolib.thermodynamics.condprob.ConditionalProbability1D2D.process_trajectory_xyz" title="Permalink to this definition"></a></dt>
<dd><p>Included for backwards compatibility, this routine will call the more general process_trajectory routine of the parent class.</p>
<p>Extract Q1, Q2 and CV samples from the given XYZ trajectories. These samples will later be utilized by the finish routine to construct the conditional probability. The trajectory files may also contain data from simulations that are biased in CV space (not Q1/Q2 space!!).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fns</strong> (<em>str</em><em> or </em><em>list</em><em>(</em><em>str</em><em>)</em>) – file name (or list of file names) which contain trajectories that are used to compute the conditional probability.</p></li>
<li><p><strong>Q1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – collective variable used to compute the Q1 value from a trajectory file</p></li>
<li><p><strong>Q2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – collective variable used to compute the Q2 value from a trajectory file</p></li>
<li><p><strong>CV</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">CollectiveVariable</span></code>) – collective variable used to compute the CV value from a trajectory file</p></li>
<li><p><strong>sub</strong> (<em>slice</em><em>, </em><em>optional</em><em>, </em><em>default=slice</em><em>(</em><em>None</em><em>, </em><em>None</em><em>, </em><em>None</em><em>)</em>) – python slice instance to subsample the trajectory</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rg.html" class="btn btn-neutral float-left" title="Reference Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rg_kin.html" class="btn btn-neutral float-right" title="Kinetics – thermolib.kinetics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Louis Vanduyfhuys.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>